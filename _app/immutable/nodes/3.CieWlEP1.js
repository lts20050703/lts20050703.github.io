import{d as fr,f as M,e as y,a as A,s as _e}from"../chunks/Ce61RJFW.js";import{a1 as vr,b as Jt,p as gr,d as x,e as mr,u as hr,g as e,h as fe,i as _,f as $e,s,c as d,t as W,a as br,r as u,n as q}from"../chunks/mJtnS1C1.js";import{e as Nt,i as wr}from"../chunks/CcYK1Ah7.js";import{i as ke}from"../chunks/D2J4IEeg.js";import{a as Et,d as yr,b as xr}from"../chunks/cPGnTZu6.js";import{d as Tr,n as At,i as Sr,r as w,v as $r,a as at,h as it,b as $,c as nt,s as kr,j as Mt}from"../chunks/vBg15EUq.js";import{t as Fr,f as jr,a as Ir}from"../chunks/DcngniA8.js";import{b as Dt,a as Ht}from"../chunks/BS63G1dM.js";import{b as Vr}from"../chunks/DE8IYXKl.js";import{H as Nr}from"../chunks/B8CXukk-.js";import{t as T,T as Er,f as Ar}from"../chunks/wwYqJERP.js";import{o as st,a as Pt,n as k,s as qt,b as Ot}from"../chunks/DCbgLHsI.js";class lt{#e=new WeakMap;#t;#r;static entries=new WeakMap;constructor(l){this.#r=l}observe(l,c){var S=this.#e.get(l)||new Set;return S.add(c),this.#e.set(l,S),this.#a().observe(l,this.#r),()=>{var D=this.#e.get(l);D.delete(c),D.size===0&&(this.#e.delete(l),this.#t.unobserve(l))}}#a(){return this.#t??(this.#t=new ResizeObserver(l=>{for(var c of l){lt.entries.set(c.target,c);for(var S of this.#e.get(c.target)||[])S(c)}}))}}var Mr=new lt({box:"border-box"});function Dr(i,l,c){var S=Mr.observe(i,()=>c(i[l]));vr(()=>(Jt(()=>c(i[l])),S))}const ot=st({same_group_fade_in_ms:k(),same_group_fade_out_ms:k(),different_group_fade_in_ms:k(),different_group_fade_out_ms:k(),volume:k(),volume_fade_ms:k(),current_phase:k(),auto_advance_every_second:k(),auto_advance:Ot(),audios:Pt(st({id:qt(),volume:k(),offset:k(),group:k(),bar_duration:k(),loops:Pt(st({start:k(),end:k(),phase:qt(),loop:Ot()}))}))}),zt=[0,Math.sqrt(.1),Math.sqrt(.2),Math.sqrt(.3),Math.sqrt(.4),Math.sqrt(.5),Math.sqrt(.6),Math.sqrt(.7),Math.sqrt(.8),Math.sqrt(.9),1],Hr=zt.toReversed();let g,N;function Pr(){g=new AudioContext,N=new GainNode(g)}function qr(i,l){const c=new AudioBufferSourceNode(g),S=new GainNode(g),D=new GainNode(g);return c.buffer=i,c.connect(S).connect(D).connect(N).connect(g.destination),{id:l,playing:!1,volume:100,offset:0,group:0,bar_duration:0,progress:0,loops:[{start:0,end:i.duration,phase:"",loop:!0}],start_time:0,buffer:i,source_node:c,fade_node:S,volume_node:D}}function Lt(i,l,c){if(c<0)return console.error("Cannot call start with negative offset.");if(i.start_time)return console.error("Cannot call start more than once without calling stop first.");i.source_node.start(l,c),i.start_time=l-c}function Or(i){if(!i.start_time)return console.error("Cannot call stop without calling start first.");i.start_time=0,i.source_node.stop(),i.source_node.disconnect(),i.source_node=new AudioBufferSourceNode(g),i.source_node.buffer=i.buffer,i.source_node.connect(i.fade_node).connect(i.volume_node).connect(N).connect(g.destination)}function Ct(i,l,c){if(i.fade_node.gain.cancelScheduledValues(g.currentTime),!c){i.fade_node.gain.setValueAtTime(1,l);return}i.fade_node.gain.cancelScheduledValues(g.currentTime),i.fade_node.gain.setValueAtTime(0,l),i.fade_node.gain.setValueCurveAtTime(zt,l,c)}function Lr(i,l,c){if(i.fade_node.gain.cancelScheduledValues(g.currentTime),!c){i.fade_node.gain.setValueAtTime(0,l);return}i.fade_node.gain.cancelScheduledValues(g.currentTime),i.fade_node.gain.setValueAtTime(1,l),i.fade_node.gain.setValueCurveAtTime(Hr,l,c)}function ve(i){if(!i)return 0;const l=i.loops[i.progress],c=g.currentTime-i.start_time;if(!l.loop||c<l.start)return c<i.buffer.duration?c:i.buffer.duration;const S=l.end-l.start;return l.start+(c-l.start)%S}function Fe(i){if(!i)return 0;const l=ve(i)%i.bar_duration;return i.bar_duration-l}function Cr(i){if(!i?.bar_duration)return g.currentTime+.1;let l=g.currentTime+Fe(i);for(;l<.1;)l+=i.bar_duration;return l}var Jr=M('<div class="absolute top-0 h-full w-1 bg-white"></div> <div class="absolute top-0 h-full w-1 bg-white"></div>',1),zr=M('<div class="h-6 w-6"></div>'),Gr=M('<div class="h-6 w-6"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 9h16.5m-16.5 6.75h16.5"></path></svg></div>'),Br=M('<button class="btn col-span-7 text-black btn-sm btn-primary">+</button>'),Rr=M('<button class="btn btn-sm btn-warning">X</button> <input class="radio radio-lg radio-primary" type="radio"/> <input type="checkbox" class="toggle toggle-lg toggle-primary"/> <input class="input input-sm w-full input-primary" type="text" inputmode="decimal"/> <input class="input input-sm w-full input-primary" type="text" inputmode="decimal"/> <input class="input input-sm w-full input-primary" type="text"/>',1),Wr=M('<button class="btn btn-sm btn-primary">+</button> <div class="col-span-6 grid grid-cols-subgrid gap-y-1"></div>',1),Yr=M('<div class="col-span-full grid grid-cols-subgrid items-center justify-center"><!> <button class="btn btn-sm btn-error">X</button> <input class="toggle toggle-lg toggle-primary" type="checkbox"/> <label class="input input-sm flex justify-end gap-1 input-primary"><input class="text-right" style="width: 3ch" type="text" inputmode="decimal"/> <div>%</div></label> <input class="input input-sm w-full max-w-full input-primary" type="text"/> <input class="input input-sm w-full input-primary" type="text" inputmode="decimal"/> <label class="input input-sm flex justify-end input-primary"><input class="text-right" style="width: 2ch" type="text" inputmode="decimal"/></label> <input class="input input-sm w-full input-primary" type="text" inputmode="decimal"/> <!></div>'),Xr=M('<section class="col-span-full grid grid-cols-subgrid gap-y-4"></section>'),Kr=M('<!> <div class="text-center text-2xl font-bold"> </div> <div class="text-center"> </div> <div><div class="flex flex-row items-center justify-center gap-4"><div class="flex flex-row items-center justify-normal gap-1"><select class="select select-sm select-primary"><option>Select a preset...</option><option>Starfruit Supernova</option><option>Passionfruit Pantheon</option></select> <div>or</div> <input class="file-input file-input-sm file-input-primary" multiple type="file" accept="audio/*"/></div> <div class="flex flex-row items-center justify-center gap-1"><input class="input input-sm input-primary" type="text" placeholder="Paste exported save here..."/> <button class="btn pointer-events-auto btn-sm btn-warning">Import</button></div> <button class="btn btn-sm btn-primary">Export</button></div> <div class="grid grid-cols-[auto_auto_auto_auto_auto] items-center justify-center gap-x-4 gap-y-1"><div class="text-right">Same Group</div> <label class="col-span-2 grid grid-cols-subgrid items-center gap-x-1"><div>Fade In Duration:</div> <div class="input input-sm flex flex-row items-center justify-end gap-1 input-primary"><input class="text-right" style="width: 4ch" type="text" inputmode="decimal"/> <div>ms</div></div></label> <label class="col-span-2 grid grid-cols-subgrid items-center gap-x-1"><div>Fade Out Duration:</div> <div class="input input-sm flex flex-row items-center justify-end gap-1 input-primary"><input class="text-right" style="width: 4ch" type="text" inputmode="decimal"/> <div>ms</div></div></label> <div>Different Group</div> <label class="col-span-2 grid grid-cols-subgrid items-center gap-x-1"><div>Fade In Duration:</div> <div class="input input-sm flex flex-row items-center justify-end gap-1 input-primary"><input class="text-right" style="width: 4ch" type="text" inputmode="decimal"/> <div>ms</div></div></label> <label class="col-span-2 grid grid-cols-subgrid items-center gap-x-1"><div>Fade Out Duration:</div> <div class="input input-sm flex flex-row items-center justify-end gap-1 input-primary"><input class="text-right" style="width: 4ch" type="text" inputmode="decimal"/> <div>ms</div></div></label></div> <div class="flex flex-row items-center justify-center gap-4"><label class="flex flex-row items-center justify-center gap-1"><div>Volume:</div> <div class="input input-sm flex flex-row items-center gap-1 input-primary"><input class="text-right" style="width: 3ch" type="text" inputmode="decimal" value="100"/> <div>%</div></div></label> <label class="flex flex-row items-center justify-center gap-1"><div>Fade Duration:</div> <div class="input input-sm flex w-auto flex-row items-center gap-1 input-primary"><input class="text-right" style="width: 4ch" type="text" inputmode="decimal"/> <div>ms</div></div></label> <label class="flex flex-row items-center justify-center gap-1"><div>Current Phase:</div> <div class="input input-sm flex w-auto flex-row items-center gap-1 input-primary"><input class="text-right" style="width: 2ch" type="text" inputmode="decimal"/></div></label> <label class="flex flex-row items-center justify-center gap-1"><div>Auto Advance Every:</div> <div class="input input-sm flex w-auto flex-row items-center gap-1 input-primary"><input class="text-right" style="width: 3ch" type="text" inputmode="decimal"/> <div>Second(s)</div></div> <input class="toggle toggle-lg toggle-primary" type="checkbox"/></label></div> <div class="relative mt-4 h-2 w-full border border-primary"><div class="h-full bg-primary"></div> <!></div> <div class="mb-4 flex w-full justify-around"><div> </div> <div> </div> <div> </div></div> <div class="grid w-full grid-cols-[2rem_2rem_3rem_auto_2fr_1fr_auto_1fr_2rem_2rem_2rem_3rem_1fr_1fr_1fr] gap-x-1 gap-y-4 rounded border border-primary p-4 text-center"><div></div> <div></div> <div>Play</div> <div>Volume</div> <div>Name</div> <div>Offset</div> <div>Group</div> <div>Bar Duration</div> <div></div> <div></div> <div></div> <div>Loop</div> <div>Loop Start</div> <div>Loop End</div> <div>Phase</div> <!></div></div> <!>',1);function da(i,l){gr(l,!0);const c=300;let S,D,j=0,p=x(!1),H=x(1e3),J=x(1e3),P=x(0),z=x(1e3),G=x(!1),O=x(0),I=x(0),E=x(1e3),ge=x(!1),B=x(""),je=x(void 0),me=x(0),ut=x(""),Ie=x(0),v=x(mr([])),m=fe(()=>e(v).find(t=>t.start_time));const Gt=fe(()=>{const t=e(m)?.loops[e(m).progress]?.start??0,r=Math.floor(t/60),n=t%60;return`${r}:${n.toFixed(3).padStart(6,"0")}`}),Bt=fe(()=>{const t=e(m)?.loops[e(m).progress]?.end??0,r=Math.floor(t/60),n=t%60;return`${r}:${n.toFixed(3).padStart(6,"0")}`}),Rt=fe(()=>e(me)*(e(m)?.loops[e(m).progress]?.start??0)/(e(m)?.buffer.duration??0)),Wt=fe(()=>e(me)*(e(m)?.loops[e(m).progress]?.end??0)/(e(m)?.buffer.duration??0)-4);hr(()=>Jt(()=>{Pr(),requestAnimationFrame(ct),document.body.addEventListener("dragover",t=>t.preventDefault()),document.body.addEventListener("drop",t=>{t.preventDefault(),be(t.dataTransfer?.files)})}));async function Ve(){for(const t of e(v)){const r=t.loops.findIndex(n=>n.phase.split(",").includes(e(I).toString()));if(r===-1){t.playing=!1;continue}t.playing=!0,t.progress=r}dt()}async function dt(){_(ge,!0);const t=e(v).find(a=>!a.start_time&&a.playing);if(t)for(const a of e(v)){const b=a.loops[a.progress]?.phase.split(","),h=t.loops[t.progress]?.phase.split(",");(a.group===0||t.group===0||a.group===t.group)&&(b?.length===0||h?.length===0||b?.some(F=>h?.includes(F)))||(a.playing=!1)}j=0;const r=Cr(e(m)),n=Fe(e(m));Yt(r),Xt(r),Y(),n&&(T("Waiting for end of bar...","warning",n*1e3),await pt(n*1e3)),j&&(T("Fading in/out...","warning",j),await pt(j)),_(ge,!1)}function Yt(t){let r=e(m);for(const n of e(v))n.start_time||!n.playing||(r?.group===n.group?Ut(n,r,t):(Kt(n,t),r=n))}function Xt(t){for(const r of e(v)){if(!r.start_time||r.playing)continue;const a=r.group===e(m)?.group?e(J):e(z);Lr(r,t,a/1e3),setTimeout(()=>Or(r),Fe(r)*1e3+a),a>j&&(j=a)}}function Kt(t,r){Lt(t,r,t.offset),Ct(t,r,e(P)/1e3),e(P)>j&&(j=e(P))}function Ut(t,r,n){if(!r)return;Ct(t,n,e(H)/1e3);const a=t.loops[t.progress]?.start-r.loops[r.progress]?.start;let b=(ve(r)||r.offset)+a;const h=b<0?Math.abs(b):0,F=b>0?b:0;Lt(t,n+h,F+Fe(r)),e(H)>j&&(j=e(H))}function Y(){for(const t of e(v))t.source_node.loop=t.loops[t.progress]?.loop??!1,t.source_node.loopStart=t.loops[t.progress]?.start??0,t.source_node.loopEnd=t.loops[t.progress]?.end??0}function ct(){requestAnimationFrame(ct);const t=ve(e(m)),r=Math.floor(t/60),n=t%60,a=e(m)?.buffer.duration??0,b=Math.floor(a/60),h=a%60;_(ut,`${r}:${n.toFixed(3).padStart(6,"0")} / ${b}:${h.toFixed(3).padStart(6,"0")}`),e(m)?.buffer.duration?_(Ie,e(me)*t/(e(m)?.buffer.duration??0)):_(Ie,0)}function he(t){if(!(t instanceof KeyboardEvent&&t.key!=="Enter")){if(!e(v).length)return T("You need to upload audio files before importing.","warning",1e4);try{const r=ot.parse(JSON.parse(e(B)));if(_(H,r.same_group_fade_in_ms,!0),_(J,r.same_group_fade_out_ms,!0),_(P,r.different_group_fade_in_ms,!0),_(z,r.different_group_fade_out_ms,!0),N.gain.setValueAtTime(r.volume/100,g.currentTime),_(E,r.volume_fade_ms,!0),_(I,r.current_phase,!0),_(O,r.auto_advance_every_second,!0),_(G,r.auto_advance,!0),!r.audios)return;for(let n=0;n<r.audios.length;n+=1){const a=r.audios[n],b=e(v).findIndex(F=>F.id===a?.id);if(b===-1)continue;const h=e(v)[b];h.volume=a.volume,h.offset=a.offset,h.group=a.group,h.bar_duration=a.bar_duration,h.loops=a.loops,e(v).splice(b,1),e(v).splice(n,0,h)}T("Imported!","success",3e3)}catch{T("Invalid save!","error",3e3)}}}async function be(t){try{if(!t?.length)return;_(p,!0);const r=[];T(`Loading ${t.length} files...`,"warning",Number.POSITIVE_INFINITY);for(const a of t)r.push(new Promise(async b=>{const h=await g.decodeAudioData(await a.arrayBuffer()),F=qr(h,a instanceof File?a.name:a.url.split("/").pop()??"");e(v).push(F),b()}));await Promise.all(r);let n=0;for(const a of t){const b=e(v).findIndex(F=>F.id===(a instanceof File?a.name:a.url.split("/").pop()));if(b===-1)continue;const h=e(v)[b];e(v).splice(b,1),e(v).splice(n,0,h),n+=1}T(`Successfully loaded all ${t.length} files!`,"success",5e3)}catch{T("Unable to decode one or more audio files!","error",5e3)}finally{S.value="",_(p,!1)}}async function pt(t){return await new Promise(r=>setTimeout(r,t))}var _t=Kr(),ft=$e(_t);Nr(ft,{get title(){return At["adaptive-music"]},get description(){return Tr["adaptive-music"]},uri:"adaptive-music"});var Ne=s(ft,2),Zt=d(Ne,!0);u(Ne);var Ee=s(Ne,2),Qt=d(Ee,!0);u(Ee);var we=s(Ee,2),Ae=d(we),Me=d(Ae),R=d(Me);R.__change=async()=>{switch(e(je)){case"SJ21_EHS":{const t=ot.parse(await(await fetch("/adaptive-music/E21_EHS.json")).json());T(`Downloading ${t.audios.length} files...`,"warning",Number.POSITIVE_INFINITY),await be(await Promise.all(t.audios.map(r=>fetch(`/adaptive-music/SJ21_EHS/${r.id}`)))),_(B,JSON.stringify(t),!0),he();break}case"sj21_grandmasterHS":{const t=ot.parse(await(await fetch("/adaptive-music/sj21_grandmasterHS.json")).json());T(`Downloading ${t.audios.length} files...`,"warning",Number.POSITIVE_INFINITY),await be(await Promise.all(t.audios.map(r=>fetch(`/adaptive-music/sj21_grandmasterHS/${r.id}`)))),_(B,JSON.stringify(t),!0),he();break}}};var De=d(R);De.value=(De.__value=void 0)??"";var He=s(De);He.value=He.__value="SJ21_EHS";var vt=s(He);vt.value=vt.__value="sj21_grandmasterHS",u(R);var Pe=s(R,4);Pe.__change=t=>be(t.currentTarget.files),Vr(Pe,t=>S=t,()=>S),u(Me);var qe=s(Me,2),X=d(qe);w(X),X.__keydown=he;var gt=s(X,2);gt.__click=he,u(qe);var mt=s(qe,2);mt.__click=async()=>{navigator.clipboard.writeText(JSON.stringify({same_group_fade_in_ms:e(H),same_group_fade_out_ms:e(J),different_group_fade_in_ms:e(P),different_group_fade_out_ms:e(z),volume:N.gain.value*100,volume_fade_ms:e(E),current_phase:e(I),auto_advance_every_second:e(O),auto_advance:e(G),audios:e(v).map(t=>({id:t.id,volume:t.volume,offset:t.offset,group:t.group,bar_duration:t.bar_duration,loops:t.loops}))})),T("Copied to clipboard!","success",3e3),T("Export does not include audio files. Next time you will need to upload audio files before importing.","warning",1e4)},u(Ae);var Oe=s(Ae,2),Le=s(d(Oe),2),ht=s(d(Le),2),K=d(ht);w(K),K.__input=t=>{let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`},q(2),u(ht),u(Le);var Ce=s(Le,2),bt=s(d(Ce),2),U=d(bt);w(U),U.__input=t=>{let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`},q(2),u(bt),u(Ce);var Je=s(Ce,4),wt=s(d(Je),2),Z=d(wt);w(Z),Z.__input=t=>{let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`},q(2),u(wt),u(Je);var yt=s(Je,2),xt=s(d(yt),2),Q=d(xt);w(Q),Q.__input=t=>{let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`},q(2),u(xt),u(yt),u(Oe);var ze=s(Oe,2),Ge=d(ze),Tt=s(d(Ge),2),Be=d(Tt);Be.__input=t=>{let r=t.currentTarget.value.length;r<3&&(r=3),t.currentTarget.style.width=`${r}ch`},q(2),u(Tt),u(Ge);var Re=s(Ge,2),St=s(d(Re),2),ee=d(St);w(ee),ee.__input=t=>{let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`},q(2),u(St),u(Re);var We=s(Re,2),$t=s(d(We),2),te=d($t);w(te),te.__input=t=>{let r=t.currentTarget.value.length;r<2&&(r=2),t.currentTarget.style.width=`${r}ch`},u($t),u(We);var kt=s(We,2),Ye=s(d(kt),2),re=d(Ye);w(re),re.__input=t=>{let r=t.currentTarget.value.length;r<3&&(r=3),t.currentTarget.style.width=`${r}ch`},q(2),u(Ye);var ye=s(Ye,2);w(ye),ye.__change=()=>{if(!e(G))return clearInterval(D);e(I)<=0&&(_(I,1),Ve()),D=setInterval(()=>{_(I,e(I)+1),Ve()},e(O)*1e3)},u(kt),u(ze);var xe=s(ze,2),Ft=d(xe),er=s(Ft,2);{var tr=t=>{var r=Jr(),n=$e(r),a=s(n,2);W(()=>{nt(n,`left: ${e(Rt)??""}px`),nt(a,`left: ${e(Wt)??""}px`)}),A(t,r)};ke(er,t=>{e(m)?.loops[e(m).progress]?.loop&&t(tr)})}u(xe);var Xe=s(xe,2),Te=d(Xe),rr=d(Te);u(Te);var Ke=s(Te,2),ar=d(Ke,!0);u(Ke);var Ue=s(Ke,2),ir=d(Ue);u(Ue),u(Xe);var jt=s(Xe,2),nr=s(d(jt),30);{var sr=t=>{var r=Xr();Nt(r,31,()=>e(v),n=>n.id,(n,a,b)=>{var h=Yr(),F=d(h);{var lr=o=>{var f=zr();A(o,f)},ur=o=>{var f=Gr();Et(f,ue=>yr?.(ue)),A(o,f)};ke(F,o=>{e(p)?o(lr):o(ur,!1)})}var Ze=s(F,2);Ze.__click=()=>{e(v).splice(e(b),1)};var ae=s(Ze,2);w(ae),ae.__change=dt;var Qe=s(ae,2),ie=d(Qe);w(ie),ie.__input=o=>{let f=o.currentTarget.value.length;f<2&&(f=2),o.currentTarget.style.width=`${f}ch`},q(2),u(Qe);var ne=s(Qe,2);w(ne);var se=s(ne,2);w(se);var et=s(se,2),oe=d(et);w(oe),oe.__input=o=>{let f=o.currentTarget.value.length;f<2&&(f=2),o.currentTarget.style.width=`${f}ch`},u(et);var le=s(et,2);w(le);var dr=s(le,2);{var cr=o=>{var f=Br();f.__click=()=>{e(a).loops.push({start:0,end:e(a).buffer.duration,phase:"",loop:!0})},W(()=>f.disabled=e(p)),A(o,f)},pr=o=>{var f=Wr(),ue=$e(f);ue.__click=()=>{e(a).loops.push({start:0,end:e(a).buffer.duration,phase:"",loop:!0})};var It=s(ue,2);Nt(It,21,()=>e(a).loops,wr,(_r,V,Se,Ur)=>{var Vt=Rr(),tt=$e(Vt);tt.__click=()=>{e(a).loops.splice(Se,1)};var L=s(tt,2);w(L),$(L,Se),L.__change=()=>{e(a).start_time=g.currentTime-ve(e(a)),e(a).progress=Se,Y()};var de=s(L,2);w(de),de.__change=C=>{e(a).start_time=g.currentTime-ve(e(a)),e(V).loop=C.currentTarget.checked,Y()};var ce=s(de,2);w(ce);var pe=s(ce,2);w(pe);var rt=s(pe,2);w(rt),W(()=>{tt.disabled=e(p)||e(a).loops.length<2,kr(L,"name",e(a).id),Mt(L,Se===e(a).progress),L.disabled=e(p),Mt(de,e(V).loop),de.disabled=e(p),ce.disabled=e(p)||!e(V).loop,$(ce,e(V).start),pe.disabled=e(p)||!e(V).loop,$(pe,e(V).end),rt.disabled=e(p)}),y("blur",ce,C=>{e(V).start=parseFloat(C.currentTarget.value)||0,Y()}),y("blur",pe,C=>{e(V).end=parseFloat(C.currentTarget.value)||0,Y()}),Dt(rt,()=>e(V).phase,C=>e(V).phase=C),A(_r,Vt)}),u(It),W(()=>ue.disabled=e(p)),A(o,f)};ke(dr,o=>{e(a).loops.length?o(pr,!1):o(cr)})}u(h),W(()=>{Ze.disabled=e(p)||e(a).playing||e(ge),ae.disabled=e(p)||e(ge)||!e(a).loops.length,ie.disabled=e(p),$(ie,e(a).volume),ne.disabled=e(p),$(ne,e(a).id),se.disabled=e(p),$(se,e(a).offset),oe.disabled=e(p),$(oe,e(a).group),le.disabled=e(p),$(le,e(a).bar_duration)}),Ht(ae,()=>e(a).playing,o=>e(a).playing=o),y("blur",ie,o=>{if(e(a).volume=parseFloat(o.currentTarget.value)||0,e(a).volume/100===e(a).volume_node.gain.value)return;T("Volume changing...","warning",e(E)),e(a).volume_node.gain.cancelScheduledValues(g.currentTime),e(a).volume_node.gain.setValueAtTime(e(a).volume_node.gain.value,g.currentTime),e(a).volume_node.gain.linearRampToValueAtTime(e(a).volume/100,g.currentTime+e(E)/1e3),o.currentTarget.value=e(a).volume.toString();let f=o.currentTarget.value.length;f<3&&(f=3),o.currentTarget.style.width=`${f}ch`}),y("blur",ne,o=>{if(o.currentTarget.value!==e(a).id){if(!o.currentTarget.value.length){T("Name cannot be empty!","error",3e3),o.currentTarget.value=e(a).id;return}if(e(v).some(f=>f.id===o.currentTarget.value)){T("Name must be unique!","error",3e3),o.currentTarget.value=e(a).id;return}e(a).id=o.currentTarget.value}}),y("blur",se,o=>e(a).offset=parseFloat(o.currentTarget.value)||0),y("blur",oe,o=>{e(a).group=parseFloat(o.currentTarget.value)||0,o.currentTarget.value=e(a).group.toString();let f=o.currentTarget.value.length;f<2&&(f=2),o.currentTarget.style.width=`${f}ch`}),y("blur",le,o=>e(a).bar_duration=parseFloat(o.currentTarget.value)||0),Fr(1,h,()=>jr,()=>({duration:c})),Ir(h,()=>Ar,()=>({duration:c})),A(n,h)}),u(r),Et(r,(n,a)=>xr?.(n,a),()=>({items:e(v),flipDurationMs:c,transformDraggedElement:n=>{n?.classList.remove("grid-cols-subgrid"),n?.classList.add("grid","grid-cols-[2rem_2rem_3rem_auto_2fr_1fr_auto_1fr_2rem_2rem_2rem_3rem_1fr_1fr_1fr]","gap-x-1")}})),y("consider",r,n=>_(v,n.detail.items,!0)),y("finalize",r,n=>_(v,n.detail.items,!0)),A(t,r)};ke(nr,t=>{e(v).length&&t(sr)})}u(jt),u(we);var or=s(we,2);Er(or),W(()=>{_e(Zt,At["adaptive-music"]),_e(Qt,$r["adaptive-music"]),at(we,1,it(["m-4 flex flex-col items-center justify-center gap-1",e(p)&&"cursor-wait"])),R.disabled=e(p)||!!e(v).length,Pe.disabled=e(p),X.disabled=e(p),gt.disabled=e(p)||!e(B),mt.disabled=e(p)||!e(v).length,K.disabled=e(p),$(K,e(H)),U.disabled=e(p),$(U,e(J)),Z.disabled=e(p),$(Z,e(P)),Q.disabled=e(p),$(Q,e(z)),Be.disabled=e(p),ee.disabled=e(p),$(ee,e(E)),te.disabled=e(p),$(te,e(I)),re.disabled=e(G)||e(p),$(re,e(O)),ye.disabled=e(O)<=0||e(p),nt(Ft,`width: ${e(Ie)??""}px`),at(Te,1,it(e(m)?.loops[e(m).progress]?.loop?"":"text-base-content/50 line-through")),_e(rr,`Loop Start ${e(Gt)??""}`),_e(ar,e(ut)),at(Ue,1,it(e(m)?.loops[e(m).progress]?.loop?"":"text-base-content/50 line-through")),_e(ir,`Loop End ${e(Bt)??""}`)}),Sr(R,()=>e(je),t=>_(je,t)),Dt(X,()=>e(B),t=>_(B,t)),y("blur",K,t=>{_(H,parseFloat(t.currentTarget.value)||0,!0),t.currentTarget.value=e(H).toString();let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`}),y("blur",U,t=>{_(J,parseFloat(t.currentTarget.value)||0,!0),t.currentTarget.value=e(J).toString();let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`}),y("blur",Z,t=>{_(P,parseFloat(t.currentTarget.value)||0,!0),t.currentTarget.value=e(P).toString();let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`}),y("blur",Q,t=>{_(z,parseFloat(t.currentTarget.value)||0,!0),t.currentTarget.value=e(z).toString();let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`}),y("blur",Be,t=>{const r=parseFloat(t.currentTarget.value)||0;if(r/100===N.gain.value)return;T("Volume changing...","warning",e(E)),N.gain.cancelScheduledValues(g.currentTime),N.gain.setValueAtTime(N.gain.value,g.currentTime),N.gain.linearRampToValueAtTime(r/100,g.currentTime+e(E)/1e3),t.currentTarget.value=r.toString();let n=t.currentTarget.value.length;n<3&&(n=3),t.currentTarget.style.width=`${n}ch`}),y("blur",ee,t=>{_(E,parseFloat(t.currentTarget.value)||0,!0),t.currentTarget.value=e(E).toString();let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`}),y("blur",te,t=>{_(I,parseFloat(t.currentTarget.value)||0,!0),Ve(),t.currentTarget.value=e(I).toString();let r=t.currentTarget.value.length;r<2&&(r=2),t.currentTarget.style.width=`${r}ch`}),y("blur",re,t=>{_(O,parseFloat(t.currentTarget.value)||0,!0),t.currentTarget.value=e(O).toString();let r=t.currentTarget.value.length;r<3&&(r=3),t.currentTarget.style.width=`${r}ch`}),Ht(ye,()=>e(G),t=>_(G,t)),Dr(xe,"clientWidth",t=>_(me,t)),A(i,_t),br()}fr(["change","keydown","click","input"]);export{da as component};
