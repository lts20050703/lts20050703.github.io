import{f as m,a as i,c as ce,t as nt}from"../chunks/D2Os11Ns.js";import{f as k,c as s,r as a,s as r,k as ze,t as w,g as e,p as tt,h as Fe,a as at,u as Te,b as qe,i as g,d as ne,m as Ze,o as Be}from"../chunks/CdrH6FGe.js";import{d as Ve,s as p,e as Ke}from"../chunks/D32HDFMs.js";import{i as O}from"../chunks/C_8Ez5C7.js";import{e as Je,i as Pe}from"../chunks/Dh-GaU7P.js";import{r as $e,s as Y,d as dt,n as Qe,v as vt}from"../chunks/PO9IuvA8.js";import{a as ct,b as Ue,c as Re}from"../chunks/C-DQbPxC.js";import{b as _t}from"../chunks/DG713H4s.js";import{r as ut}from"../chunks/BrYugXLR.js";import{H as mt}from"../chunks/Cigh2edi.js";import{L as ft}from"../chunks/DOUyAul8.js";import{i as n,b as rt,d as st,h as pt,x as ot,M as We,a as bt,e as gt,p as yt,c as xt,f as wt}from"../chunks/Cq-Pmsgv.js";import{t as Ne,T as ht}from"../chunks/D7WT8dLS.js";import{r as lt,s as t,m as Xe,f as Ye,n as kt,l as St,d as It,a as Oe,b as x,e as $t,c as jt}from"../chunks/Nrqgik9B.js";import{N as At,D as Nt}from"../chunks/BfODlWfG.js";import{a as et,d as Ot,f as Dt,b as Et}from"../chunks/0Vtho8RT.js";import{c as Ft,s as Le}from"../chunks/B7jqvjGK.js";import{a as Jt}from"../chunks/DxFkQ900.js";import"../chunks/D90JgJ2n.js";const Lt=pe=>{var _e=Ct(),G=k(_e);G.__click=()=>{for(const L of lt){if(t.roles.includes(L))continue;(Xe.includes(L)||Ye.includes(L))&&t.roles.push(L)}};var ee=s(G,!0);a(G);var H=r(G,2),_=s(H),S=s(_,!0);a(_);var te=r(_,2);Mt(te,()=>L=>Xe.includes(L)||Ye.includes(L)),a(H),w(()=>{p(ee,n.add_all_roles),p(S,n.msn25)}),i(pe,_e)},Mt=(pe,_e=ze)=>{var G=ce(),ee=k(G);Je(ee,1,()=>lt,H=>H,(H,_)=>{var S=ce(),te=k(S);{var L=ae=>{var I=Gt(),M=k(I),de=s(M,!0);a(M);var B=r(M,2);$e(B);var A=r(B,2),re=s(A,!0);a(A),w((T,F,Q)=>{Le(M,1,`text-right ${T??""}`),Y(M,"for",e(_)),p(de,n.role_names[e(_)]),B.disabled=e(_)==="villager"||e(_)==="werewolf",Y(B,"id",e(_)),Le(A,1,F),Y(A,"for",e(_)),p(re,Q)},[()=>t.roles.includes(e(_))?"text-primary":"",()=>Ft(t.roles.includes(e(_))?"text-primary/50":"text-base-content/50"),()=>e(_).replaceAll("_"," ").replaceAll("25","").replaceAll("24","")]),ct(B,()=>t.roles.includes(e(_)),T=>{if(T&&!t.roles.includes(e(_)))t.roles.push(e(_));else if(!T&&t.roles.includes(e(_))){const F=t.roles.indexOf(e(_));F>-1&&t.roles.splice(F,1)}}),i(ae,I)};O(te,ae=>{_e()(e(_))&&ae(L)})}i(H,S)}),i(pe,G)};var Ct=m('<button class="btn btn-sm btn-primary"> </button> <div class="grid grid-cols-[1fr_auto_1fr] items-center justify-center gap-x-2 gap-y-1"><div class="col-span-3 mt-4 text-center text-lg font-bold"> </div> <!></div>',1),Gt=m('<label> </label> <input class="toggle toggle-primary" type="checkbox"/> <label> </label>',1);Ve(["click"]);var Ht=m('<div class="col-span-full grid grid-cols-subgrid gap-1"><div class="h-6 w-6"><!></div> <input type="text"/> <button class="btn px-1 btn-sm btn-error"><!></button></div>'),Tt=m('<div class="grid grid-cols-[auto_1fr_auto] items-center justify-center gap-1 rounded border border-primary p-1"><div></div> <div class="text-center"> </div> <div></div> <section class="col-span-full grid grid-cols-subgrid gap-1"></section></div>'),qt=m('<hr class="my-2 w-full opacity-25"/> <div> </div> <!> <hr class="my-2 w-full opacity-25"/> <!> <hr class="my-2 w-full opacity-25"/> <div class="text-center text-3xl"> </div> <!> <!> <button class="btn btn-primary"> </button>',1);function zt(pe,_e){tt(_e,!0);const G=300,ee=Fe(()=>t.players.some(F=>t.players.some(Q=>F.id!==Q.id&&F.name===Q.name))),H=Fe(()=>t.players.some(F=>!F.name));var _=qt(),S=r(k(_),2),te=s(S,!0);a(S);var L=r(S,2);rt(L);var ae=r(L,4);{var I=F=>{var Q=Tt(),we=r(s(Q),2),je=s(we,!0);a(we);var be=r(we,4);Je(be,31,()=>t.players,D=>D.id,(D,ve,De)=>{var ge=Ht(),ye=s(ge),Me=s(ye);pt(Me),a(ye),et(ye,l=>Ot?.(l));var xe=r(ye,2);$e(xe);var ue=r(xe,2);ue.__click=()=>{const l=t.players.indexOf(e(ve));l!==-1&&t.players.splice(l,1)};var Ce=s(ue);ot(Ce),a(ue),a(ge),w(l=>{Le(xe,1,`input input-sm ${l??""}`),Y(xe,"placeholder",`${n.player_name??""}...`),ue.disabled=t.players.length<=2,Y(ue,"aria-label",n.remove_player)},[()=>!e(ve).name||t.players.some((l,o)=>o!==e(De)&&l.name===e(ve).name)?"input-warning":"input-primary"]),Ue(xe,()=>e(ve).name,l=>e(ve).name=l),Jt(ge,()=>Dt,()=>({duration:G})),i(D,ge)}),a(be),et(be,(D,ve)=>Et?.(D,ve),()=>({items:t.players,flipDurationMs:G,transformDraggedElement:D=>{D?.classList.remove("grid-cols-subgrid"),D?.classList.add("grid","grid-cols-[auto_1fr_auto]")}})),a(Q),w(()=>p(je,n.player_name)),Ke("consider",be,D=>{t.players=D.detail.items}),Ke("finalize",be,D=>{t.players=D.detail.items}),i(F,Q)};O(ae,F=>{t.players.length&&F(I)})}var M=r(ae,4),de=s(M,!0);a(M);var B=r(M,2);Lt(B);var A=r(B,2);st(A);var re=r(A,2);re.__click=()=>{t.time="night",t.night===0?kt():t.current_role?t.time="night":t.time="day"};var T=s(re,!0);a(re),w(()=>{Le(S,1,`text-3xl ${e(ee)||e(H)?"text-warning":"text-success"}`),p(te,n.players),p(de,n.roles),re.disabled=e(ee)||e(H),p(T,n.start)}),i(pe,_),at()}Ve(["click"]);var Ut=m('<button class="btn btn-sm btn-primary"> </button>'),Vt=m('<input class="input input-sm input-primary"/>'),Zt=m('<div class="font-bold"> </div>'),Bt=m('<div class="flex flex-row items-center justify-between gap-4"><!> <button class="btn btn-sm"><!></button></div>'),Kt=m('<div class="font-bold"> </div>'),Pt=m("<div> </div>"),Qt=m("<div> <!></div>"),Rt=m("<div> </div>"),Wt=m("<div></div>"),Xt=m("<!> <!> <div> </div> <div> </div> <div> </div>",1),Yt=m('<button class="btn btn-sm"> </button> <!> <hr class="my-2 w-full opacity-25"/> <div class="tabs-lift tabs w-full"><input type="radio" name="section" class="tab border-b-0! [--tab-border-color:--color-base-content]"/> <div class="tab-content border-base-content bg-base-100 p-4"><div class="flex flex-col items-center justify-center gap-1"><!> <hr class="my-2 w-full opacity-25"/> <!> <hr class="my-2 w-full opacity-25"/> <!></div></div> <input type="radio" name="section" class="tab border-b-0! [--tab-border-color:--color-base-content]"/> <div class="tab-content border-base-content bg-base-100 p-4"><div class="flex flex-col items-center justify-center gap-1"><!></div></div></div> <!> <!>',1),ea=m("<!> <!>",1),ta=m('<div class="flex w-full flex-row justify-between"><button class="btn btn-sm"> </button> <button class="btn btn-sm"> </button></div> <!>',1),aa=m('<div class="flex w-full flex-row justify-between"><button class="btn btn-sm"> </button> <button class="btn btn-sm"> </button></div> <!> <hr class="my-2 w-full opacity-25"/> <!>',1),ra=m(`<div class="fixed bottom-4 z-50 flex w-full flex-col items-center justify-center gap-1 p-1 text-center"><div>If Link ask you to export save state (or you know how to manually update the save file
						to the latest version), click the link below</div> <a class="link link-primary underline-offset-8">Go to debug page</a></div>`),sa=m("<!> <!>",1),oa=m('<div class="flex flex-col border p-4"><!> <hr class="my-2 w-full opacity-25"/> <button class="btn mt-2 w-full btn-primary">Load</button> <hr class="my-2 w-full opacity-25"/> <div class="flex flex-row gap-1"><button class="btn grow btn-sm btn-error">Delete</button> <button class="btn btn-sm"> </button></div></div>'),la=m("<option> </option>"),ia=m('<div class="mt-4 flex flex-row gap-1"><input class="input input-sm grow input-primary" type="text"/> <button class="btn px-1 btn-sm btn-error"><!></button></div>'),na=m('<div class="mt-4 flex flex-col gap-4"><select class="select w-full select-primary"><option>Use Default MSN 2025 Config</option><!><option>Import save file</option></select> <!> <div class="flex flex-col gap-1"><!></div></div>'),da=m('<button class="btn btn-primary">New Game</button>'),va=m('<button class="btn btn-error">Delete</button>'),ca=m('<div class="relative mt-8 w-full"><div class="flex justify-center"><div class="absolute -top-5 rounded bg-base-100 px-4 pt-4"><div class="rounded border px-4 pb-1 text-3xl font-bold">SAVE DATA</div></div></div> <div class="flex w-full flex-col gap-4 rounded bg-base-100 p-4"><div class="flex flex-col-reverse gap-4 rounded border p-4 pt-10"><!> <div><button class="btn w-full btn-primary">New Game</button></div></div></div></div> <!> <!>',1),_a=m('<!> <div class="text-center text-2xl font-bold"> </div> <div class="text-center"> </div> <div class="m-1 mb-12 flex items-center justify-center"><div class="flex w-full max-w-sm flex-col items-center justify-center gap-1"><!> <!> <!></div></div>',1);function Ea(pe,_e){tt(_e,!0);const G=[],ee=l=>{var o=Ut();o.__click=()=>{if(e(I)===-1)return console.warn("No file to save");const q=x[e(I)];q.time=t.time,q.day=t.day,q.night=t.night,q.current_role=t.current_role,q.roles=t.roles,q.players=t.players.map(me=>me.name),localStorage.setItem("werewolf-moderator.slots",JSON.stringify(x)),g(I,-1)};var K=s(o,!0);a(o),w(()=>p(K,n.save_and_quit)),i(l,o)},H=(l,o=ze,K=ze,q,me)=>{let he=Ze(()=>Be(q?.(),!0)),ke=Ze(()=>Be(me?.(),!0));var J=ce(),C=k(J);{var z=U=>{var R=Xt(),v=k(R);{var f=c=>{var d=Bt(),b=s(d);{var W=le=>{var X=Vt();$e(X),X.__change=()=>{localStorage.setItem("werewolf-moderator.slots",JSON.stringify(x))},w(()=>Y(X,"placeholder",`File #${K()+1}`)),Ue(X,()=>o().label,Ae=>o().label=Ae),i(le,X)},se=le=>{var X=Zt(),Ae=s(X,!0);a(X),w(()=>p(Ae,o().label||`File #${K()+1}`)),i(le,X)};O(b,le=>{e(re)?le(W):le(se,!1)})}var Z=r(b,2);Z.__click=()=>{g(re,!e(re))};var oe=s(Z);wt(oe,()=>"size-4"),a(Z),a(d),i(c,d)},u=c=>{var d=Kt(),b=s(d,!0);a(d),w(()=>p(b,o().label||`File #${K()+1}`)),i(c,d)};O(v,c=>{e(he)?c(f):c(u,!1)})}var y=r(v,2);{var P=c=>{var d=ce(),b=k(d);{var W=Z=>{var oe=Pt(),le=s(oe,!0);a(oe),w(()=>p(le,n.setup)),i(Z,oe)},se=Z=>{var oe=ce(),le=k(oe);{var X=Se=>{var Ie=Qt(),Ee=s(Ie),Ge=r(Ee);{var He=ie=>{var fe=nt();w(()=>p(fe,`(${n.role_names[o().current_role]??""})`)),i(ie,fe)};O(Ge,ie=>{o().current_role&&ie(He)})}a(Ie),w(()=>p(Ee,`${n.night??""} #${o().night??""} `)),i(Se,Ie)},Ae=Se=>{var Ie=ce(),Ee=k(Ie);{var Ge=ie=>{var fe=Rt(),it=s(fe);a(fe),w(()=>p(it,`${n.day??""} #${o().day??""}`)),i(ie,fe)},He=ie=>{var fe=Wt();i(ie,fe)};O(Ee,ie=>{o().time==="day"?ie(Ge):ie(He,!1)},!0)}i(Se,Ie)};O(le,Se=>{o().time==="night"?Se(X):Se(Ae,!1)},!0)}i(Z,oe)};O(b,Z=>{o().time==="setup"?Z(W):Z(se,!1)})}i(c,d)};O(y,c=>{e(ke)&&c(P)})}var $=r(y,2),E=s($);a($);var h=r($,2),N=s(h);a(h);var V=r(h,2),j=s(V);a(V),w((c,d,b)=>{p(E,`Deck: ${c??""}`),p(N,`${n.roles??""}: ${d??""}`),p(j,`${n.player??""}: ${b??""}`)},[()=>o().deck.map(c=>n[c]).join(", "),()=>o().roles.map(c=>n.role_names[c]).join(", "),()=>o().players.join(", ")]),i(U,R)};O(C,U=>{o()&&U(z)})}i(l,J)};let _=ne(!1),S=ne("loading"),te=ne("players");const L=Fe(()=>t.players.some(l=>t.players.some(o=>l.id!==o.id&&l.name===o.name))),ae=Fe(()=>t.players.some(l=>!l.name));let I=ne(-1),M=ne(void 0),de=ne(-1),B=ne(void 0),A=ne(-1),re=ne(!1),T=ne("");function F(){if(e(T)==="")return;Oe(e(T))==="loaded"?Ne("Imported save state!","success",3e3):Ne("Failed to import save state!","error",3e3)}Te(()=>qe(()=>{g(I,parseInt(localStorage.getItem("werewolf-moderator.file")??"-1"),!0),St(localStorage.getItem("werewolf-moderator.slots"));const l=localStorage.getItem("werewolf-moderator");l&&(localStorage.setItem("werewolf-moderator[0]",l),localStorage.removeItem("werewolf-moderator"))})),Te(()=>{e(S)!=="loaded"||e(I)===-1||(localStorage.setItem(`werewolf-moderator[${e(I)}]`,It(t)),qe(()=>Ne("Autosaved!","success",1e3)))}),Te(()=>{e(I)!==-1?(localStorage.setItem("werewolf-moderator.file",e(I).toString()),g(S,Oe(localStorage.getItem(`werewolf-moderator[${e(I)}]`)),!0),qe(()=>{const l=x[e(I)];l&&(l.time=t.time,l.day=t.day,l.night=t.night,l.current_role=t.current_role,l.roles=t.roles,l.players=t.players.map(o=>o.name),localStorage.setItem("werewolf-moderator.slots",JSON.stringify(x)))})):(localStorage.removeItem("werewolf-moderator.file"),g(S,"loaded"))}),Object.entries(n).forEach(([l,o])=>{typeof o=="string"&&(o.includes(" (25)")||o.includes(" (24)"))&&(n[l]=o.replaceAll(" (25)","").replaceAll(" (24)",""))}),Object.entries(n.role_names).forEach(([l,o])=>{typeof o=="string"&&(o.includes(" (25)")||o.includes(" (24)"))&&(n.role_names[l]=o.replaceAll(" (25)","").replaceAll(" (24)",""))}),Object.entries(n.flags_descriptions).forEach(([l,o])=>{typeof o=="string"&&(o.includes(" (25)")||o.includes(" (24)"))&&(n.flags_descriptions[l]=o.replaceAll(" (25)","").replaceAll(" (24)",""))});var Q=_a(),we=k(Q);mt(we,{get title(){return Qe.msn},get description(){return dt.msn},uri:"msn"});var je=r(we,2),be=s(je,!0);a(je);var D=r(je,2),ve=s(D,!0);a(D);var De=r(D,2),ge=s(De),ye=s(ge);{var Me=l=>{var o=sa(),K=k(o);{var q=J=>{var C=Yt(),z=k(C);z.__click=()=>{g(_,!1)};var U=s(z,!0);a(z);var R=r(z,2);bt(R);var v=r(R,4),f=s(v);$e(f),f.value=f.__value="players";var u=r(f,2),y=s(u),P=s(y);rt(P);var $=r(P,4);gt($);var E=r($,4);yt(E),a(y),a(u);var h=r(u,2);$e(h),h.value=h.__value="roles";var N=r(h,2),V=s(N),j=s(V);xt(j),a(V),a(N),a(v);var c=r(v,2);st(c);var d=r(c,2);ee(d),w(()=>{z.disabled=e(L)||e(ae),p(U,n.back),Y(f,"aria-label",n.players),Y(h,"aria-label",n.roles)}),Re(G,[],f,()=>e(te),b=>g(te,b)),Re(G,[],h,()=>e(te),b=>g(te,b)),i(J,C)},me=J=>{var C=ce(),z=k(C);{var U=v=>{var f=ea(),u=k(f);ee(u);var y=r(u,2);zt(y,{}),i(v,f)},R=v=>{var f=ce(),u=k(f);{var y=$=>{var E=ta(),h=k(E),N=s(h);N.__click=()=>{t.time="setup"};var V=s(N,!0);a(N);var j=r(N,2);j.__click=()=>{g(_,!0)};var c=s(j,!0);a(j),a(h);var d=r(h,2);At(d,{}),w(()=>{p(V,n.setup),p(c,n.advanced_settings)}),i($,E)},P=$=>{var E=ce(),h=k(E);{var N=V=>{var j=aa(),c=k(j),d=s(c);d.__click=()=>{t.time="setup"};var b=s(d,!0);a(d);var W=r(d,2);W.__click=()=>{g(_,!0)};var se=s(W,!0);a(W),a(c);var Z=r(c,2);Nt(Z,{});var oe=r(Z,4);ee(oe),w(()=>{p(b,n.setup),p(se,n.advanced_settings)}),i(V,j)};O(h,V=>{t.time==="day"&&V(N)},!0)}i($,E)};O(u,$=>{t.time==="night"?$(y):$(P,!1)},!0)}i(v,f)};O(z,v=>{t.time==="setup"?v(U):v(R,!1)},!0)}i(J,C)};O(K,J=>{e(_)?J(q):J(me,!1)})}var he=r(K,2);{var ke=J=>{var C=ra(),z=r(s(C),2);a(C),w(U=>Y(z,"href",U),[()=>ut("/msn/debug/")]),i(J,C)};O(he,J=>{e(S)==="error"&&J(ke)})}i(l,o)},xe=l=>{var o=ca(),K=k(o),q=r(s(K),2),me=s(q),he=s(me);Je(he,17,()=>x,Pe,(U,R,v)=>{var f=oa(),u=s(f);H(u,()=>e(R),()=>v);var y=r(u,4);y.__click=()=>{g(I,v,!0),g(S,"loading"),g(S,Oe(localStorage.getItem(`werewolf-moderator[${e(I)}]`)),!0),g(_,!1)};var P=r(y,4),$=s(P);$.__click=()=>{e(M)?.showModal(),g(de,v,!0)};var E=r($,2);E.__pointerup=async()=>{try{const N=localStorage.getItem(`werewolf-moderator[${v+1}]`);if(!N)throw new Error("Save not found");navigator.clipboard.writeText(N),Ne("Copied to clipboard!","success",3e3)}catch{Ne("Failed to copy to clipboard!","error",15e3)}};var h=s(E,!0);a(E),a(P),a(f),w(()=>p(h,n.copy_save_state_to_clipboard)),i(U,f)});var ke=r(he,2),J=s(ke);J.__click=()=>{g(A,-1),e(B)?.showModal()},a(ke),a(me),a(q),a(K);var C=r(K,2);We(C,{title:"New Game Config",get modal(){return e(B)},set modal(v){g(B,v,!0)},body:v=>{var f=na(),u=s(f),y=s(u);y.value=y.__value=-1;var P=r(y);Je(P,17,()=>({length:x.length}),Pe,(j,c,d)=>{var b=la(),W=s(b);a(b);var se={};w(()=>{p(W,`Use ${(x[x.length-d-1].label||`File #${x.length-d}`)??""}'s Config`),se!==(se=x.length-d-1)&&(b.value=b.__value=x.length-d-1)}),i(j,b)});var $=r(P);$.value=$.__value=-2,a(u);var E=r(u,2);{var h=j=>{var c=ia(),d=s(c);$e(d);var b=r(d,2);b.__click=()=>{g(T,"")};var W=s(b);ot(W),a(b),a(c),w(()=>{Y(d,"placeholder",n.save_state),b.disabled=!e(T),Y(b,"aria-label",n.clear)}),Ue(d,()=>e(T),se=>g(T,se)),i(j,c)};O(E,j=>{e(A)===-2&&j(h)})}var N=r(E,2),V=s(N);H(V,()=>x[e(A)],()=>e(A),()=>!1,()=>!1),a(N),a(f),_t(u,()=>e(A),j=>g(A,j)),i(v,f)},buttons:v=>{var f=da();f.__click=()=>{if(g(I,x.length,!0),g(S,"loading"),e(A)===-2)F(),t.deck=["msn25"],x.push({label:"",time:t.time,deck:t.deck,roles:t.roles,players:t.players.map(u=>u.name),night:t.night,current_role:t.current_role,day:t.day});else if(e(A)===-1)g(S,Oe("{}"),!0),x.push({label:"",time:"setup",deck:["msn25"],day:0,night:0,current_role:void 0,roles:["werewolf","villager"],players:["1","2"]});else{const u=jt.parse(JSON.parse(localStorage.getItem(`werewolf-moderator[${e(A)+1}]`)??"{}"));Oe("{}"),t.deck=u.deck,t.roles=u.roles,t.players=u.players.map(y=>({id:y.id,name:y.name,alive:!0,role:void 0,score:0})),x.push({label:"",time:"setup",deck:t.deck,roles:t.roles,players:t.players.map(y=>y.name),night:0,current_role:void 0,day:0})}localStorage.setItem("werewolf-moderator.slots",JSON.stringify(x)),g(_,!1)},i(v,f)},$$slots:{body:!0,buttons:!0}});var z=r(C,2);We(z,{title:"Delete?",get modal(){return e(M)},set modal(v){g(M,v,!0)},body:v=>{H(v,()=>x[e(de)],()=>e(de),()=>!1)},buttons:v=>{var f=va();f.__click=()=>{for(let u=e(de);u<x.length-1;u+=1){const y=localStorage.getItem(`werewolf-moderator[${u+1}]`);y&&localStorage.setItem(`werewolf-moderator[${u}]`,y)}x.splice(e(de),1),localStorage.setItem("werewolf-moderator.slots",JSON.stringify(x)),e(M)?.close()},i(v,f)},$$slots:{body:!0,buttons:!0}}),i(l,o)};O(ye,l=>{e(I)!==-1?l(Me):l(xe,!1)})}var ue=r(ye,2);ht(ue,{});var Ce=r(ue,2);ft(Ce,{get status(){return e(S)},get clear_save(){return $t}}),a(ge),a(De),w(()=>{p(be,Qe.msn),p(ve,vt["werewolf-moderator"])}),i(pe,Q),at()}Ve(["click","change","pointerup"]);export{Ea as component};
