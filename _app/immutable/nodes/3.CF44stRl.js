import"../chunks/DsnmJJEf.js";import{a0 as fr,e as zt,p as vr,h as S,i as gr,u as mr,g as e,j as fe,k as _,f as q,a as Te,s as o,d as p,t as z,b as P,c as hr,$ as br,r as c,n as L}from"../chunks/fRTlKJc5.js";import{d as wr,h as yr,e as T,s as ve}from"../chunks/ChByKK8l.js";import{i as Se}from"../chunks/BGNtTwbM.js";import{e as Nt,i as xr}from"../chunks/BTnqOMW6.js";import{a as Et,d as Tr,b as Sr,f as $r}from"../chunks/BBZ_rXgf.js";import{r as y,a as k,s as kr,b as At}from"../chunks/BjZBy5iL.js";import{s as it,c as Mt}from"../chunks/CB-vSWM3.js";import{s as nt}from"../chunks/B754rq1e.js";import{a as Fr}from"../chunks/BzEYSeOJ.js";import{b as Dt,a as Pt}from"../chunks/D3jRnHxe.js";import{b as jr}from"../chunks/DAksJ9NG.js";import{b as Ir}from"../chunks/BX2B2b48.js";import{n as qt,v as Vr}from"../chunks/DVSrS0GQ.js";import{t as $,T as Nr}from"../chunks/brOtyZDp.js";import{o as st,a as Ht,n as F,s as Ot,c as Lt}from"../chunks/DLM6tR0h.js";class lt{#e=new WeakMap;#t;#r;static entries=new WeakMap;constructor(n){this.#r=n}observe(n,u){var h=this.#e.get(n)||new Set;return h.add(u),this.#e.set(n,h),this.#a().observe(n,this.#r),()=>{var j=this.#e.get(n);j.delete(u),j.size===0&&(this.#e.delete(n),this.#t.unobserve(n))}}#a(){return this.#t??(this.#t=new ResizeObserver(n=>{for(var u of n){lt.entries.set(u.target,u);for(var h of this.#e.get(u.target)||[])h(u)}}))}}var Er=new lt({box:"border-box"});function Ar(i,n,u){var h=Er.observe(i,()=>u(i[n]));fr(()=>(zt(()=>u(i[n])),h))}const ot=st({same_group_fade_in_ms:F(),same_group_fade_out_ms:F(),different_group_fade_in_ms:F(),different_group_fade_out_ms:F(),volume:F(),volume_fade_ms:F(),current_phase:F(),auto_advance_every_second:F(),auto_advance:Lt(),audios:Ht(st({id:Ot(),volume:F(),offset:F(),group:F(),bar_duration:F(),loops:Ht(st({start:F(),end:F(),phase:Ot(),loop:Lt()}))}))}),Gt=[0,Math.sqrt(.1),Math.sqrt(.2),Math.sqrt(.3),Math.sqrt(.4),Math.sqrt(.5),Math.sqrt(.6),Math.sqrt(.7),Math.sqrt(.8),Math.sqrt(.9),1],Mr=Gt.toReversed();let m,M;function Dr(){m=new AudioContext,M=new GainNode(m)}function Pr(i,n){const u=new AudioBufferSourceNode(m),h=new GainNode(m),j=new GainNode(m);return u.buffer=i,u.connect(h).connect(j).connect(M).connect(m.destination),{id:n,playing:!1,volume:100,offset:0,group:0,bar_duration:0,progress:0,loops:[{start:0,end:i.duration,phase:"",loop:!0}],start_time:0,buffer:i,source_node:u,fade_node:h,volume_node:j}}function Ct(i,n,u){if(u<0)return console.error("Cannot call start with negative offset.");if(i.start_time)return console.error("Cannot call start more than once without calling stop first.");i.source_node.start(n,u),i.start_time=n-u}function qr(i){if(!i.start_time)return console.error("Cannot call stop without calling start first.");i.start_time=0,i.source_node.stop(),i.source_node.disconnect(),i.source_node=new AudioBufferSourceNode(m),i.source_node.buffer=i.buffer,i.source_node.connect(i.fade_node).connect(i.volume_node).connect(M).connect(m.destination)}function Jt(i,n,u){if(i.fade_node.gain.cancelScheduledValues(m.currentTime),!u){i.fade_node.gain.setValueAtTime(1,n);return}i.fade_node.gain.cancelScheduledValues(m.currentTime),i.fade_node.gain.setValueAtTime(0,n),i.fade_node.gain.setValueCurveAtTime(Gt,n,u)}function Hr(i,n,u){if(i.fade_node.gain.cancelScheduledValues(m.currentTime),!u){i.fade_node.gain.setValueAtTime(0,n);return}i.fade_node.gain.cancelScheduledValues(m.currentTime),i.fade_node.gain.setValueAtTime(1,n),i.fade_node.gain.setValueCurveAtTime(Mr,n,u)}function R(i){if(!i)return 0;const n=i.loops[i.progress],u=m.currentTime-i.start_time;if(!n.loop||u<n.start)return u<i.buffer.duration?u:i.buffer.duration;const h=n.end-n.start;return n.start+(u-n.start)%h}function $e(i){if(!i)return 0;const n=R(i)%i.bar_duration;return i.bar_duration-n}function ge(i){if(!i?.bar_duration)return m.currentTime+.1;let n=m.currentTime+$e(i);for(;n<.1;)n+=i.bar_duration;return n}var Or=async(i,n,u,h,j)=>{switch(e(n)){case"SJ21_EHS":{const w=ot.parse(await(await fetch("/adaptive-music/E21_EHS.json")).json());$(`Downloading ${w.audios.length} files...`,"warning",Number.POSITIVE_INFINITY),await u(await Promise.all(w.audios.map(d=>fetch(`/adaptive-music/SJ21_EHS/${d.id}`)))),_(h,JSON.stringify(w),!0),j();break}case"sj21_grandmasterHS":{const w=ot.parse(await(await fetch("/adaptive-music/sj21_grandmasterHS.json")).json());$(`Downloading ${w.audios.length} files...`,"warning",Number.POSITIVE_INFINITY),await u(await Promise.all(w.audios.map(d=>fetch(`/adaptive-music/sj21_grandmasterHS/${d.id}`)))),_(h,JSON.stringify(w),!0),j();break}}},Lr=(i,n)=>n(i.currentTarget.files),Cr=async(i,n,u,h,j,w,d,V,H,N)=>{navigator.clipboard.writeText(JSON.stringify({same_group_fade_in_ms:e(n),same_group_fade_out_ms:e(u),different_group_fade_in_ms:e(h),different_group_fade_out_ms:e(j),volume:M.gain.value*100,volume_fade_ms:e(w),current_phase:e(d),auto_advance_every_second:e(V),auto_advance:e(H),audios:e(N).map(I=>({id:I.id,volume:I.volume,offset:I.offset,group:I.group,bar_duration:I.bar_duration,loops:I.loops}))})),$("Copied to clipboard!","success",3e3),$("Export does not include audio files. Next time you will need to upload audio files before importing.","warning",1e4)},Jr=q('<div class="absolute top-0 h-full w-1 bg-white"></div> <div class="absolute top-0 h-full w-1 bg-white"></div>',1),zr=q('<div class="h-6 w-6"></div>'),Gr=q('<div class="h-6 w-6"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 9h16.5m-16.5 6.75h16.5"></path></svg></div>'),Br=(i,n)=>{e(n).loops.push({start:0,end:e(n).buffer.duration,phase:"",loop:!0})},Rr=q('<button class="btn btn-primary btn-sm col-span-7 text-black">+</button>'),Wr=(i,n)=>{e(n).loops.push({start:0,end:e(n).buffer.duration,phase:"",loop:!0})},Yr=(i,n,u,h)=>{e(n).start_time=m.currentTime-R(e(n)),e(u).loop=i.currentTarget.checked,h()},Xr=q('<button class="btn btn-warning btn-sm">X</button> <input class="radio-primary radio radio-lg" type="radio"/> <input type="checkbox" class="toggle toggle-primary toggle-lg"/> <input class="input input-sm input-primary w-full" type="text" inputmode="decimal"/> <input class="input input-sm input-primary w-full" type="text" inputmode="decimal"/> <input class="input input-sm input-primary w-full" type="text"/>',1),Kr=q('<button class="btn btn-primary btn-sm">+</button> <div class="col-span-6 grid grid-cols-subgrid gap-y-1"></div>',1),Ur=q('<div class="col-span-full grid grid-cols-subgrid items-center justify-center"><!> <button class="btn btn-error btn-sm">X</button> <input class="toggle toggle-primary toggle-lg" type="checkbox"/> <label class="input input-sm input-primary flex justify-end gap-1"><input class="text-right" style="width: 3ch" type="text" inputmode="decimal"/> <div>%</div></label> <input class="input input-sm input-primary w-full max-w-full" type="text"/> <input class="input input-sm input-primary w-full" type="text" inputmode="decimal"/> <label class="input input-sm input-primary flex justify-end"><input class="text-right" style="width: 2ch" type="text" inputmode="decimal"/></label> <input class="input input-sm input-primary w-full" type="text" inputmode="decimal"/> <!></div>'),Zr=q('<section class="col-span-full grid grid-cols-subgrid gap-y-4"></section>'),Qr=q('<div class="text-center text-2xl font-bold"> </div> <div class="text-center"> </div> <!> <div><div class="flex flex-row items-center justify-center gap-4"><div class="flex flex-row items-center justify-normal gap-1"><select class="select select-primary select-sm"><option>Select a preset...</option><option>Starfruit Supernova</option><option>Passionfruit Pantheon</option></select> <div>or</div> <input class="file-input file-input-primary file-input-sm" multiple type="file" accept="audio/*"/></div> <div class="flex flex-row items-center justify-center gap-1"><input class="input input-sm input-primary" type="text" placeholder="Paste exported save here..."/> <button class="btn btn-warning btn-sm pointer-events-auto">Import</button></div> <button class="btn btn-primary btn-sm">Export</button></div> <div class="grid grid-cols-[auto_auto_auto_auto_auto] items-center justify-center gap-x-4 gap-y-1"><div class="text-right">Same Group</div> <label class="col-span-2 grid grid-cols-subgrid items-center gap-x-1"><div>Fade In Duration:</div> <div class="input input-sm input-primary flex flex-row items-center justify-end gap-1"><input class="text-right" style="width: 4ch" type="text" inputmode="decimal"/> <div>ms</div></div></label> <label class="col-span-2 grid grid-cols-subgrid items-center gap-x-1"><div>Fade Out Duration:</div> <div class="input input-sm input-primary flex flex-row items-center justify-end gap-1"><input class="text-right" style="width: 4ch" type="text" inputmode="decimal"/> <div>ms</div></div></label> <div>Different Group</div> <label class="col-span-2 grid grid-cols-subgrid items-center gap-x-1"><div>Fade In Duration:</div> <div class="input input-sm input-primary flex flex-row items-center justify-end gap-1"><input class="text-right" style="width: 4ch" type="text" inputmode="decimal"/> <div>ms</div></div></label> <label class="col-span-2 grid grid-cols-subgrid items-center gap-x-1"><div>Fade Out Duration:</div> <div class="input input-sm input-primary flex flex-row items-center justify-end gap-1"><input class="text-right" style="width: 4ch" type="text" inputmode="decimal"/> <div>ms</div></div></label></div> <div class="flex flex-row items-center justify-center gap-4"><label class="flex flex-row items-center justify-center gap-1"><div>Volume:</div> <div class="input input-sm input-primary flex flex-row items-center gap-1"><input class="text-right" style="width: 3ch" type="text" inputmode="decimal" value="100"/> <div>%</div></div></label> <label class="flex flex-row items-center justify-center gap-1"><div>Fade Duration:</div> <div class="input input-sm input-primary flex w-auto flex-row items-center gap-1"><input class="text-right" style="width: 4ch" type="text" inputmode="decimal"/> <div>ms</div></div></label> <label class="flex flex-row items-center justify-center gap-1"><div>Current Phase:</div> <div class="input input-sm input-primary flex w-auto flex-row items-center gap-1"><input class="text-right" style="width: 2ch" type="text" inputmode="decimal"/></div></label> <label class="flex flex-row items-center justify-center gap-1"><div>Auto Advance Every:</div> <div class="input input-sm input-primary flex w-auto flex-row items-center gap-1"><input class="text-right" style="width: 3ch" type="text" inputmode="decimal"/> <div>Second(s)</div></div> <input class="toggle toggle-primary toggle-lg" type="checkbox"/></label></div> <div class="border-primary relative mt-4 h-2 w-full border"><div class="bg-primary h-full"></div> <!></div> <div class="mb-4 flex w-full justify-around"><div> </div> <div> </div> <div> </div></div> <div class="border-primary grid w-full grid-cols-[2rem_2rem_3rem_auto_2fr_1fr_auto_1fr_2rem_2rem_2rem_3rem_1fr_1fr_1fr] gap-x-1 gap-y-4 rounded border p-4 text-center"><div></div> <div></div> <div>Play</div> <div>Volume</div> <div>Name</div> <div>Offset</div> <div>Group</div> <div>Bar Duration</div> <div></div> <div></div> <div></div> <div>Loop</div> <div>Loop Start</div> <div>Loop End</div> <div>Phase</div> <!></div></div>',1);function ma(i,n){vr(n,!0);const u=300;let h,j,w=0,d=S(!1),V=S(1e3),H=S(1e3),N=S(0),I=S(1e3),G=S(!1),C=S(0),E=S(0),D=S(1e3),me=S(!1),W=S(""),ke=S(void 0),he=S(0),ut=S(""),Fe=S(0),v=S(gr([])),g=fe(()=>e(v).find(t=>t.start_time));const Bt=fe(()=>{const t=e(g)?.loops[e(g).progress]?.start??0,r=Math.floor(t/60),s=t%60;return`${r}:${s.toFixed(3).padStart(6,"0")}`}),Rt=fe(()=>{const t=e(g)?.loops[e(g).progress]?.end??0,r=Math.floor(t/60),s=t%60;return`${r}:${s.toFixed(3).padStart(6,"0")}`}),Wt=fe(()=>e(he)*(e(g)?.loops[e(g).progress]?.start??0)/(e(g)?.buffer.duration??0)),Yt=fe(()=>e(he)*(e(g)?.loops[e(g).progress]?.end??0)/(e(g)?.buffer.duration??0)-4);mr(()=>zt(()=>{Dr(),requestAnimationFrame(ct),document.body.addEventListener("dragover",t=>t.preventDefault()),document.body.addEventListener("drop",t=>{t.preventDefault(),Ve(t.dataTransfer?.files)})}));async function je(){for(const t of e(v)){const r=t.loops.findIndex(s=>s.phase.split(",").includes(e(E).toString()));if(r===-1){t.playing=!1;continue}t.playing=!0,t.start_time=m.currentTime-R(t),t.progress=r}dt()}async function dt(){_(me,!0);const t=e(v).find(s=>!s.start_time&&s.playing);if(t)for(const s of e(v)){const a=s.loops[s.progress]?.phase.split(","),x=t.loops[t.progress]?.phase.split(",");(s.group===0||t.group===0||s.group===t.group)&&(a?.length===0||x?.length===0||a?.some(b=>x?.includes(b)))||(s.playing=!1)}w=0,Xt(),Kt(),Y();const r=$e(e(g));r&&($("Waiting for end of bar...","warning",r*1e3),await pt(r*1e3)),w&&($("Fading in/out...","warning",w),await pt(w)),_(me,!1)}function Xt(){let t=e(g);for(const r of e(v))r.start_time||!r.playing||(t?.group===r.group?Zt(r,t):(Ut(r),t=r))}function Kt(){for(const t of e(v)){if(!t.start_time||t.playing)continue;const s=t.group===e(g)?.group?e(H):e(I);Hr(t,ge(e(g)),s/1e3),setTimeout(()=>qr(t),$e(t)*1e3+s),s>w&&(w=s)}}function Ut(t){Ct(t,ge(e(g)),t.offset),Jt(t,ge(e(g)),e(N)/1e3),e(N)>w&&(w=e(N))}function Zt(t,r){if(!r)return;Jt(t,ge(r),e(V)/1e3);const s=t.loops[t.progress]?.start-r.loops[r.progress]?.start;let a=(R(r)||r.offset)+s;const x=a<0?Math.abs(a):0,b=a>0?a:0;Ct(t,ge(r)+x,b+$e(r)),e(V)>w&&(w=e(V))}function Y(){for(const t of e(v))t.source_node.loop=t.loops[t.progress]?.loop??!1,t.source_node.loopStart=t.loops[t.progress]?.start??0,t.source_node.loopEnd=t.loops[t.progress]?.end??0}function ct(){requestAnimationFrame(ct);const t=R(e(g)),r=Math.floor(t/60),s=t%60,a=e(g)?.buffer.duration??0,x=Math.floor(a/60),b=a%60;_(ut,`${r}:${s.toFixed(3).padStart(6,"0")} / ${x}:${b.toFixed(3).padStart(6,"0")}`),e(g)?.buffer.duration?_(Fe,e(he)*t/(e(g)?.buffer.duration??0)):_(Fe,0)}function Ie(t){if(!(t instanceof KeyboardEvent&&t.key!=="Enter")){if(!e(v).length)return $("You need to upload audio files before importing.","warning",1e4);try{const r=ot.parse(JSON.parse(e(W)));if(_(V,r.same_group_fade_in_ms,!0),_(H,r.same_group_fade_out_ms,!0),_(N,r.different_group_fade_in_ms,!0),_(I,r.different_group_fade_out_ms,!0),M.gain.setValueAtTime(r.volume/100,m.currentTime),_(D,r.volume_fade_ms,!0),_(E,r.current_phase,!0),_(C,r.auto_advance_every_second,!0),_(G,r.auto_advance,!0),!r.audios)return;for(let s=0;s<r.audios.length;s+=1){const a=r.audios[s],x=e(v).findIndex(O=>O.id===a?.id);if(x===-1)continue;const b=e(v)[x];b.volume=a.volume,b.offset=a.offset,b.group=a.group,b.bar_duration=a.bar_duration,b.loops=a.loops,e(v).splice(x,1),e(v).splice(s,0,b)}$("Imported!","success",3e3)}catch{$("Invalid save!","error",3e3)}}}async function Ve(t){try{if(!t?.length)return;_(d,!0);const r=[];$(`Loading ${t.length} files...`,"warning",Number.POSITIVE_INFINITY);for(const a of t)r.push(new Promise(async x=>{const b=await m.decodeAudioData(await a.arrayBuffer()),O=Pr(b,a instanceof File?a.name:a.url.split("/").pop()??"");e(v).push(O),x()}));await Promise.all(r);let s=0;for(const a of t){const x=e(v).findIndex(O=>O.id===(a instanceof File?a.name:a.url.split("/").pop()));if(x===-1)continue;const b=e(v)[x];e(v).splice(x,1),e(v).splice(s,0,b),s+=1}$(`Successfully loaded all ${t.length} files!`,"success",5e3)}catch{$("Unable to decode one or more audio files!","error",5e3)}finally{h.value="",_(d,!1)}}async function pt(t){return await new Promise(r=>setTimeout(r,t))}var _t=Qr();yr(t=>{z(()=>br.title=qt["adaptive-music"])});var Ne=Te(_t),Qt=p(Ne,!0);c(Ne);var Ee=o(Ne,2),er=p(Ee,!0);c(Ee);var ft=o(Ee,2);Nr(ft,{});var Ae=o(ft,2),Me=p(Ae),De=p(Me),B=p(De);B.__change=[Or,ke,Ve,W,Ie];var Pe=p(B);Pe.value=(Pe.__value=void 0)??"";var qe=o(Pe);qe.value=qe.__value="SJ21_EHS";var vt=o(qe);vt.value=vt.__value="sj21_grandmasterHS",c(B);var He=o(B,4);He.__change=[Lr,Ve],Ir(He,t=>h=t,()=>h),c(De);var Oe=o(De,2),X=p(Oe);y(X),X.__keydown=Ie;var gt=o(X,2);gt.__click=Ie,c(Oe);var mt=o(Oe,2);mt.__click=[Cr,V,H,N,I,D,E,C,G,v],c(Me);var Le=o(Me,2),Ce=o(p(Le),2),ht=o(p(Ce),2),K=p(ht);y(K),K.__input=t=>{let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`},L(2),c(ht),c(Ce);var Je=o(Ce,2),bt=o(p(Je),2),U=p(bt);y(U),U.__input=t=>{let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`},L(2),c(bt),c(Je);var ze=o(Je,4),wt=o(p(ze),2),Z=p(wt);y(Z),Z.__input=t=>{let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`},L(2),c(wt),c(ze);var yt=o(ze,2),xt=o(p(yt),2),Q=p(xt);y(Q),Q.__input=t=>{let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`},L(2),c(xt),c(yt),c(Le);var Ge=o(Le,2),Be=p(Ge),Tt=o(p(Be),2),Re=p(Tt);Re.__input=t=>{let r=t.currentTarget.value.length;r<3&&(r=3),t.currentTarget.style.width=`${r}ch`},L(2),c(Tt),c(Be);var We=o(Be,2),St=o(p(We),2),ee=p(St);y(ee),ee.__input=t=>{let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`},L(2),c(St),c(We);var Ye=o(We,2),$t=o(p(Ye),2),te=p($t);y(te),te.__input=t=>{let r=t.currentTarget.value.length;r<2&&(r=2),t.currentTarget.style.width=`${r}ch`},c($t),c(Ye);var kt=o(Ye,2),Xe=o(p(kt),2),re=p(Xe);y(re),re.__input=t=>{let r=t.currentTarget.value.length;r<3&&(r=3),t.currentTarget.style.width=`${r}ch`},L(2),c(Xe);var be=o(Xe,2);y(be),be.__change=()=>{if(!e(G))return clearInterval(j);e(E)<=0&&(_(E,1),je()),j=setInterval(()=>{_(E,e(E)+1),je()},e(C)*1e3)},c(kt),c(Ge);var we=o(Ge,2),Ft=p(we),tr=o(Ft,2);{var rr=t=>{var r=Jr(),s=Te(r),a=o(s,2);z(()=>{nt(s,`left: ${e(Wt)??""}px`),nt(a,`left: ${e(Yt)??""}px`)}),P(t,r)};Se(tr,t=>{e(g)?.loops[e(g).progress]?.loop&&t(rr)})}c(we);var Ke=o(we,2),ye=p(Ke),ar=p(ye);c(ye);var Ue=o(ye,2),ir=p(Ue,!0);c(Ue);var Ze=o(Ue,2),nr=p(Ze);c(Ze),c(Ke);var jt=o(Ke,2),sr=o(p(jt),30);{var or=t=>{var r=Zr();Nt(r,31,()=>e(v),s=>s.id,(s,a,x)=>{var b=Ur(),O=p(b);{var lr=l=>{var f=zr();P(l,f)},ur=l=>{var f=Gr();Et(f,ue=>Tr?.(ue)),P(l,f)};Se(O,l=>{e(d)?l(lr):l(ur,!1)})}var Qe=o(O,2);Qe.__click=()=>{e(v).splice(e(x),1)};var ae=o(Qe,2);y(ae),ae.__change=dt;var et=o(ae,2),ie=p(et);y(ie),ie.__input=l=>{let f=l.currentTarget.value.length;f<2&&(f=2),l.currentTarget.style.width=`${f}ch`},L(2),c(et);var ne=o(et,2);y(ne);var se=o(ne,2);y(se);var tt=o(se,2),oe=p(tt);y(oe),oe.__input=l=>{let f=l.currentTarget.value.length;f<2&&(f=2),l.currentTarget.style.width=`${f}ch`},c(tt);var le=o(tt,2);y(le);var dr=o(le,2);{var cr=l=>{var f=Rr();f.__click=[Br,a],z(()=>f.disabled=e(d)),P(l,f)},pr=l=>{var f=Kr(),ue=Te(f);ue.__click=[Wr,a];var It=o(ue,2);Nt(It,21,()=>e(a).loops,xr,(_r,A,xe,ea)=>{var Vt=Xr(),rt=Te(Vt);rt.__click=()=>{e(a).loops.splice(xe,1)};var J=o(rt,2);y(J),k(J,xe),J.__change=()=>{e(a).start_time=m.currentTime-R(e(a)),e(a).progress=xe,Y()};var de=o(J,2);y(de),de.__change=[Yr,a,A,Y];var ce=o(de,2);y(ce);var pe=o(ce,2);y(pe);var at=o(pe,2);y(at),z(()=>{rt.disabled=e(d)||e(a).loops.length<2,kr(J,"name",e(a).id),At(J,xe===e(a).progress),J.disabled=e(d),At(de,e(A).loop),de.disabled=e(d),ce.disabled=e(d)||!e(A).loop,k(ce,e(A).start),pe.disabled=e(d)||!e(A).loop,k(pe,e(A).end),at.disabled=e(d)}),T("blur",ce,_e=>{e(A).start=parseFloat(_e.currentTarget.value)||0,Y()}),T("blur",pe,_e=>{e(A).end=parseFloat(_e.currentTarget.value)||0,Y()}),Dt(at,()=>e(A).phase,_e=>e(A).phase=_e),P(_r,Vt)}),c(It),z(()=>ue.disabled=e(d)),P(l,f)};Se(dr,l=>{e(a).loops.length?l(pr,!1):l(cr)})}c(b),z(()=>{Qe.disabled=e(d)||e(a).playing||e(me),ae.disabled=e(d)||e(me)||!e(a).loops.length,ie.disabled=e(d),k(ie,e(a).volume),ne.disabled=e(d),k(ne,e(a).id),se.disabled=e(d),k(se,e(a).offset),oe.disabled=e(d),k(oe,e(a).group),le.disabled=e(d),k(le,e(a).bar_duration)}),Pt(ae,()=>e(a).playing,l=>e(a).playing=l),T("blur",ie,l=>{if(e(a).volume=parseFloat(l.currentTarget.value)||0,e(a).volume/100===e(a).volume_node.gain.value)return;$("Volume changing...","warning",e(D)),e(a).volume_node.gain.cancelScheduledValues(m.currentTime),e(a).volume_node.gain.setValueAtTime(e(a).volume_node.gain.value,m.currentTime),e(a).volume_node.gain.linearRampToValueAtTime(e(a).volume/100,m.currentTime+e(D)/1e3),l.currentTarget.value=e(a).volume.toString();let f=l.currentTarget.value.length;f<3&&(f=3),l.currentTarget.style.width=`${f}ch`}),T("blur",ne,l=>{if(l.currentTarget.value!==e(a).id){if(!l.currentTarget.value.length){$("Name cannot be empty!","error",3e3),l.currentTarget.value=e(a).id;return}if(e(v).some(f=>f.id===l.currentTarget.value)){$("Name must be unique!","error",3e3),l.currentTarget.value=e(a).id;return}e(a).id=l.currentTarget.value}}),T("blur",se,l=>e(a).offset=parseFloat(l.currentTarget.value)||0),T("blur",oe,l=>{e(a).group=parseFloat(l.currentTarget.value)||0,l.currentTarget.value=e(a).group.toString();let f=l.currentTarget.value.length;f<2&&(f=2),l.currentTarget.style.width=`${f}ch`}),T("blur",le,l=>e(a).bar_duration=parseFloat(l.currentTarget.value)||0),Fr(b,()=>$r,()=>({duration:u})),P(s,b)}),c(r),Et(r,(s,a)=>Sr?.(s,a),()=>({items:e(v),flipDurationMs:u,transformDraggedElement:s=>{s?.classList.remove("grid-cols-subgrid"),s?.classList.add("grid","grid-cols-[2rem_2rem_3rem_auto_2fr_1fr_auto_1fr_2rem_2rem_2rem_3rem_1fr_1fr_1fr]","gap-x-1")}})),T("consider",r,s=>_(v,s.detail.items,!0)),T("finalize",r,s=>_(v,s.detail.items,!0)),P(t,r)};Se(sr,t=>{e(v).length&&t(or)})}c(jt),c(Ae),z(()=>{ve(Qt,qt["adaptive-music"]),ve(er,Vr["adaptive-music"]),it(Ae,1,`m-4 flex flex-col items-center justify-center gap-1 ${e(d)?"cursor-wait":""}`),B.disabled=e(d)||!!e(v).length,He.disabled=e(d),X.disabled=e(d),gt.disabled=e(d)||!e(W),mt.disabled=e(d)||!e(v).length,K.disabled=e(d),k(K,e(V)),U.disabled=e(d),k(U,e(H)),Z.disabled=e(d),k(Z,e(N)),Q.disabled=e(d),k(Q,e(I)),Re.disabled=e(d),ee.disabled=e(d),k(ee,e(D)),te.disabled=e(d),k(te,e(E)),re.disabled=e(G)||e(d),k(re,e(C)),be.disabled=e(C)<=0||e(d),nt(Ft,`width: ${e(Fe)??""}px`),it(ye,1,Mt(e(g)?.loops[e(g).progress]?.loop?"":"text-base-content/50 line-through")),ve(ar,`Loop Start ${e(Bt)??""}`),ve(ir,e(ut)),it(Ze,1,Mt(e(g)?.loops[e(g).progress]?.loop?"":"text-base-content/50 line-through")),ve(nr,`Loop End ${e(Rt)??""}`)}),jr(B,()=>e(ke),t=>_(ke,t)),Dt(X,()=>e(W),t=>_(W,t)),T("blur",K,t=>{_(V,parseFloat(t.currentTarget.value)||0,!0),t.currentTarget.value=e(V).toString();let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`}),T("blur",U,t=>{_(H,parseFloat(t.currentTarget.value)||0,!0),t.currentTarget.value=e(H).toString();let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`}),T("blur",Z,t=>{_(N,parseFloat(t.currentTarget.value)||0,!0),t.currentTarget.value=e(N).toString();let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`}),T("blur",Q,t=>{_(I,parseFloat(t.currentTarget.value)||0,!0),t.currentTarget.value=e(I).toString();let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`}),T("blur",Re,t=>{const r=parseFloat(t.currentTarget.value)||0;if(r/100===M.gain.value)return;$("Volume changing...","warning",e(D)),M.gain.cancelScheduledValues(m.currentTime),M.gain.setValueAtTime(M.gain.value,m.currentTime),M.gain.linearRampToValueAtTime(r/100,m.currentTime+e(D)/1e3),t.currentTarget.value=r.toString();let s=t.currentTarget.value.length;s<3&&(s=3),t.currentTarget.style.width=`${s}ch`}),T("blur",ee,t=>{_(D,parseFloat(t.currentTarget.value)||0,!0),t.currentTarget.value=e(D).toString();let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`}),T("blur",te,t=>{_(E,parseFloat(t.currentTarget.value)||0,!0),je(),t.currentTarget.value=e(E).toString();let r=t.currentTarget.value.length;r<2&&(r=2),t.currentTarget.style.width=`${r}ch`}),T("blur",re,t=>{_(C,parseFloat(t.currentTarget.value)||0,!0),t.currentTarget.value=e(C).toString();let r=t.currentTarget.value.length;r<3&&(r=3),t.currentTarget.style.width=`${r}ch`}),Pt(be,()=>e(G),t=>_(G,t)),Ar(we,"clientWidth",t=>_(he,t)),P(i,_t),hr()}wr(["change","keydown","click","input"]);export{ma as component};
