import{f as M,a as A}from"../chunks/D2Os11Ns.js";import{D as fr,b as zt,p as vr,d as x,e as gr,u as mr,g as e,h as _e,i as _,f as Se,s,c as d,t as W,a as hr,r as u,n as q}from"../chunks/CdrH6FGe.js";import{d as br,e as y,s as fe}from"../chunks/D32HDFMs.js";import{i as $e}from"../chunks/C_8Ez5C7.js";import{e as Nt,i as wr}from"../chunks/Dh-GaU7P.js";import{f as yr,a as Et,d as xr,b as Tr}from"../chunks/0Vtho8RT.js";import{d as Sr,n as At,r as w,v as $r,a as $,s as kr,c as Mt}from"../chunks/Bq4LcSYx.js";import{s as at,c as Dt}from"../chunks/B7jqvjGK.js";import{s as it}from"../chunks/BD6Q5sWJ.js";import{a as Fr}from"../chunks/DxFkQ900.js";import{b as Ht,a as Pt}from"../chunks/C-DQbPxC.js";import{b as jr}from"../chunks/DG713H4s.js";import{b as Ir}from"../chunks/mG4M-Ku5.js";import{H as Vr}from"../chunks/BEnaQkc5.js";import{t as T,T as Nr}from"../chunks/D7WT8dLS.js";import{o as nt,a as qt,n as k,s as Ot,c as Lt}from"../chunks/zY0APpH_.js";class ot{#e=new WeakMap;#t;#r;static entries=new WeakMap;constructor(l){this.#r=l}observe(l,p){var S=this.#e.get(l)||new Set;return S.add(p),this.#e.set(l,S),this.#a().observe(l,this.#r),()=>{var D=this.#e.get(l);D.delete(p),D.size===0&&(this.#e.delete(l),this.#t.unobserve(l))}}#a(){return this.#t??(this.#t=new ResizeObserver(l=>{for(var p of l){ot.entries.set(p.target,p);for(var S of this.#e.get(p.target)||[])S(p)}}))}}var Er=new ot({box:"border-box"});function Ar(i,l,p){var S=Er.observe(i,()=>p(i[l]));fr(()=>(zt(()=>p(i[l])),S))}const st=nt({same_group_fade_in_ms:k(),same_group_fade_out_ms:k(),different_group_fade_in_ms:k(),different_group_fade_out_ms:k(),volume:k(),volume_fade_ms:k(),current_phase:k(),auto_advance_every_second:k(),auto_advance:Lt(),audios:qt(nt({id:Ot(),volume:k(),offset:k(),group:k(),bar_duration:k(),loops:qt(nt({start:k(),end:k(),phase:Ot(),loop:Lt()}))}))}),Gt=[0,Math.sqrt(.1),Math.sqrt(.2),Math.sqrt(.3),Math.sqrt(.4),Math.sqrt(.5),Math.sqrt(.6),Math.sqrt(.7),Math.sqrt(.8),Math.sqrt(.9),1],Mr=Gt.toReversed();let g,N;function Dr(){g=new AudioContext,N=new GainNode(g)}function Hr(i,l){const p=new AudioBufferSourceNode(g),S=new GainNode(g),D=new GainNode(g);return p.buffer=i,p.connect(S).connect(D).connect(N).connect(g.destination),{id:l,playing:!1,volume:100,offset:0,group:0,bar_duration:0,progress:0,loops:[{start:0,end:i.duration,phase:"",loop:!0}],start_time:0,buffer:i,source_node:p,fade_node:S,volume_node:D}}function Ct(i,l,p){if(p<0)return console.error("Cannot call start with negative offset.");if(i.start_time)return console.error("Cannot call start more than once without calling stop first.");i.source_node.start(l,p),i.start_time=l-p}function Pr(i){if(!i.start_time)return console.error("Cannot call stop without calling start first.");i.start_time=0,i.source_node.stop(),i.source_node.disconnect(),i.source_node=new AudioBufferSourceNode(g),i.source_node.buffer=i.buffer,i.source_node.connect(i.fade_node).connect(i.volume_node).connect(N).connect(g.destination)}function Jt(i,l,p){if(i.fade_node.gain.cancelScheduledValues(g.currentTime),!p){i.fade_node.gain.setValueAtTime(1,l);return}i.fade_node.gain.cancelScheduledValues(g.currentTime),i.fade_node.gain.setValueAtTime(0,l),i.fade_node.gain.setValueCurveAtTime(Gt,l,p)}function qr(i,l,p){if(i.fade_node.gain.cancelScheduledValues(g.currentTime),!p){i.fade_node.gain.setValueAtTime(0,l);return}i.fade_node.gain.cancelScheduledValues(g.currentTime),i.fade_node.gain.setValueAtTime(1,l),i.fade_node.gain.setValueCurveAtTime(Mr,l,p)}function ve(i){if(!i)return 0;const l=i.loops[i.progress],p=g.currentTime-i.start_time;if(!l.loop||p<l.start)return p<i.buffer.duration?p:i.buffer.duration;const S=l.end-l.start;return l.start+(p-l.start)%S}function ke(i){if(!i)return 0;const l=ve(i)%i.bar_duration;return i.bar_duration-l}function Or(i){if(!i?.bar_duration)return g.currentTime+.1;let l=g.currentTime+ke(i);for(;l<.1;)l+=i.bar_duration;return l}var Lr=M('<div class="absolute top-0 h-full w-1 bg-white"></div> <div class="absolute top-0 h-full w-1 bg-white"></div>',1),Cr=M('<div class="h-6 w-6"></div>'),Jr=M('<div class="h-6 w-6"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 9h16.5m-16.5 6.75h16.5"></path></svg></div>'),zr=M('<button class="btn col-span-7 text-black btn-sm btn-primary">+</button>'),Gr=M('<button class="btn btn-sm btn-warning">X</button> <input class="radio radio-lg radio-primary" type="radio"/> <input type="checkbox" class="toggle toggle-lg toggle-primary"/> <input class="input input-sm w-full input-primary" type="text" inputmode="decimal"/> <input class="input input-sm w-full input-primary" type="text" inputmode="decimal"/> <input class="input input-sm w-full input-primary" type="text"/>',1),Br=M('<button class="btn btn-sm btn-primary">+</button> <div class="col-span-6 grid grid-cols-subgrid gap-y-1"></div>',1),Rr=M('<div class="col-span-full grid grid-cols-subgrid items-center justify-center"><!> <button class="btn btn-sm btn-error">X</button> <input class="toggle toggle-lg toggle-primary" type="checkbox"/> <label class="input input-sm flex justify-end gap-1 input-primary"><input class="text-right" style="width: 3ch" type="text" inputmode="decimal"/> <div>%</div></label> <input class="input input-sm w-full max-w-full input-primary" type="text"/> <input class="input input-sm w-full input-primary" type="text" inputmode="decimal"/> <label class="input input-sm flex justify-end input-primary"><input class="text-right" style="width: 2ch" type="text" inputmode="decimal"/></label> <input class="input input-sm w-full input-primary" type="text" inputmode="decimal"/> <!></div>'),Wr=M('<section class="col-span-full grid grid-cols-subgrid gap-y-4"></section>'),Yr=M('<!> <div class="text-center text-2xl font-bold"> </div> <div class="text-center"> </div> <!> <div><div class="flex flex-row items-center justify-center gap-4"><div class="flex flex-row items-center justify-normal gap-1"><select class="select select-sm select-primary"><option>Select a preset...</option><option>Starfruit Supernova</option><option>Passionfruit Pantheon</option></select> <div>or</div> <input class="file-input file-input-sm file-input-primary" multiple type="file" accept="audio/*"/></div> <div class="flex flex-row items-center justify-center gap-1"><input class="input input-sm input-primary" type="text" placeholder="Paste exported save here..."/> <button class="btn pointer-events-auto btn-sm btn-warning">Import</button></div> <button class="btn btn-sm btn-primary">Export</button></div> <div class="grid grid-cols-[auto_auto_auto_auto_auto] items-center justify-center gap-x-4 gap-y-1"><div class="text-right">Same Group</div> <label class="col-span-2 grid grid-cols-subgrid items-center gap-x-1"><div>Fade In Duration:</div> <div class="input input-sm flex flex-row items-center justify-end gap-1 input-primary"><input class="text-right" style="width: 4ch" type="text" inputmode="decimal"/> <div>ms</div></div></label> <label class="col-span-2 grid grid-cols-subgrid items-center gap-x-1"><div>Fade Out Duration:</div> <div class="input input-sm flex flex-row items-center justify-end gap-1 input-primary"><input class="text-right" style="width: 4ch" type="text" inputmode="decimal"/> <div>ms</div></div></label> <div>Different Group</div> <label class="col-span-2 grid grid-cols-subgrid items-center gap-x-1"><div>Fade In Duration:</div> <div class="input input-sm flex flex-row items-center justify-end gap-1 input-primary"><input class="text-right" style="width: 4ch" type="text" inputmode="decimal"/> <div>ms</div></div></label> <label class="col-span-2 grid grid-cols-subgrid items-center gap-x-1"><div>Fade Out Duration:</div> <div class="input input-sm flex flex-row items-center justify-end gap-1 input-primary"><input class="text-right" style="width: 4ch" type="text" inputmode="decimal"/> <div>ms</div></div></label></div> <div class="flex flex-row items-center justify-center gap-4"><label class="flex flex-row items-center justify-center gap-1"><div>Volume:</div> <div class="input input-sm flex flex-row items-center gap-1 input-primary"><input class="text-right" style="width: 3ch" type="text" inputmode="decimal" value="100"/> <div>%</div></div></label> <label class="flex flex-row items-center justify-center gap-1"><div>Fade Duration:</div> <div class="input input-sm flex w-auto flex-row items-center gap-1 input-primary"><input class="text-right" style="width: 4ch" type="text" inputmode="decimal"/> <div>ms</div></div></label> <label class="flex flex-row items-center justify-center gap-1"><div>Current Phase:</div> <div class="input input-sm flex w-auto flex-row items-center gap-1 input-primary"><input class="text-right" style="width: 2ch" type="text" inputmode="decimal"/></div></label> <label class="flex flex-row items-center justify-center gap-1"><div>Auto Advance Every:</div> <div class="input input-sm flex w-auto flex-row items-center gap-1 input-primary"><input class="text-right" style="width: 3ch" type="text" inputmode="decimal"/> <div>Second(s)</div></div> <input class="toggle toggle-lg toggle-primary" type="checkbox"/></label></div> <div class="relative mt-4 h-2 w-full border border-primary"><div class="h-full bg-primary"></div> <!></div> <div class="mb-4 flex w-full justify-around"><div> </div> <div> </div> <div> </div></div> <div class="grid w-full grid-cols-[2rem_2rem_3rem_auto_2fr_1fr_auto_1fr_2rem_2rem_2rem_3rem_1fr_1fr_1fr] gap-x-1 gap-y-4 rounded border border-primary p-4 text-center"><div></div> <div></div> <div>Play</div> <div>Volume</div> <div>Name</div> <div>Offset</div> <div>Group</div> <div>Bar Duration</div> <div></div> <div></div> <div></div> <div>Loop</div> <div>Loop Start</div> <div>Loop End</div> <div>Phase</div> <!></div></div>',1);function pa(i,l){vr(l,!0);const p=300;let S,D,j=0,c=x(!1),H=x(1e3),J=x(1e3),P=x(0),z=x(1e3),G=x(!1),O=x(0),I=x(0),E=x(1e3),ge=x(!1),B=x(""),Fe=x(void 0),me=x(0),lt=x(""),je=x(0),v=x(gr([])),m=_e(()=>e(v).find(t=>t.start_time));const Bt=_e(()=>{const t=e(m)?.loops[e(m).progress]?.start??0,r=Math.floor(t/60),n=t%60;return`${r}:${n.toFixed(3).padStart(6,"0")}`}),Rt=_e(()=>{const t=e(m)?.loops[e(m).progress]?.end??0,r=Math.floor(t/60),n=t%60;return`${r}:${n.toFixed(3).padStart(6,"0")}`}),Wt=_e(()=>e(me)*(e(m)?.loops[e(m).progress]?.start??0)/(e(m)?.buffer.duration??0)),Yt=_e(()=>e(me)*(e(m)?.loops[e(m).progress]?.end??0)/(e(m)?.buffer.duration??0)-4);mr(()=>zt(()=>{Dr(),requestAnimationFrame(dt),document.body.addEventListener("dragover",t=>t.preventDefault()),document.body.addEventListener("drop",t=>{t.preventDefault(),be(t.dataTransfer?.files)})}));async function Ie(){for(const t of e(v)){const r=t.loops.findIndex(n=>n.phase.split(",").includes(e(I).toString()));if(r===-1){t.playing=!1;continue}t.playing=!0,t.progress=r}ut()}async function ut(){_(ge,!0);const t=e(v).find(a=>!a.start_time&&a.playing);if(t)for(const a of e(v)){const b=a.loops[a.progress]?.phase.split(","),h=t.loops[t.progress]?.phase.split(",");(a.group===0||t.group===0||a.group===t.group)&&(b?.length===0||h?.length===0||b?.some(F=>h?.includes(F)))||(a.playing=!1)}j=0;const r=Or(e(m)),n=ke(e(m));Xt(r),Kt(r),Y(),n&&(T("Waiting for end of bar...","warning",n*1e3),await ct(n*1e3)),j&&(T("Fading in/out...","warning",j),await ct(j)),_(ge,!1)}function Xt(t){let r=e(m);for(const n of e(v))n.start_time||!n.playing||(r?.group===n.group?Zt(n,r,t):(Ut(n,t),r=n))}function Kt(t){for(const r of e(v)){if(!r.start_time||r.playing)continue;const a=r.group===e(m)?.group?e(J):e(z);qr(r,t,a/1e3),setTimeout(()=>Pr(r),ke(r)*1e3+a),a>j&&(j=a)}}function Ut(t,r){Ct(t,r,t.offset),Jt(t,r,e(P)/1e3),e(P)>j&&(j=e(P))}function Zt(t,r,n){if(!r)return;Jt(t,n,e(H)/1e3);const a=t.loops[t.progress]?.start-r.loops[r.progress]?.start;let b=(ve(r)||r.offset)+a;const h=b<0?Math.abs(b):0,F=b>0?b:0;Ct(t,n+h,F+ke(r)),e(H)>j&&(j=e(H))}function Y(){for(const t of e(v))t.source_node.loop=t.loops[t.progress]?.loop??!1,t.source_node.loopStart=t.loops[t.progress]?.start??0,t.source_node.loopEnd=t.loops[t.progress]?.end??0}function dt(){requestAnimationFrame(dt);const t=ve(e(m)),r=Math.floor(t/60),n=t%60,a=e(m)?.buffer.duration??0,b=Math.floor(a/60),h=a%60;_(lt,`${r}:${n.toFixed(3).padStart(6,"0")} / ${b}:${h.toFixed(3).padStart(6,"0")}`),e(m)?.buffer.duration?_(je,e(me)*t/(e(m)?.buffer.duration??0)):_(je,0)}function he(t){if(!(t instanceof KeyboardEvent&&t.key!=="Enter")){if(!e(v).length)return T("You need to upload audio files before importing.","warning",1e4);try{const r=st.parse(JSON.parse(e(B)));if(_(H,r.same_group_fade_in_ms,!0),_(J,r.same_group_fade_out_ms,!0),_(P,r.different_group_fade_in_ms,!0),_(z,r.different_group_fade_out_ms,!0),N.gain.setValueAtTime(r.volume/100,g.currentTime),_(E,r.volume_fade_ms,!0),_(I,r.current_phase,!0),_(O,r.auto_advance_every_second,!0),_(G,r.auto_advance,!0),!r.audios)return;for(let n=0;n<r.audios.length;n+=1){const a=r.audios[n],b=e(v).findIndex(F=>F.id===a?.id);if(b===-1)continue;const h=e(v)[b];h.volume=a.volume,h.offset=a.offset,h.group=a.group,h.bar_duration=a.bar_duration,h.loops=a.loops,e(v).splice(b,1),e(v).splice(n,0,h)}T("Imported!","success",3e3)}catch{T("Invalid save!","error",3e3)}}}async function be(t){try{if(!t?.length)return;_(c,!0);const r=[];T(`Loading ${t.length} files...`,"warning",Number.POSITIVE_INFINITY);for(const a of t)r.push(new Promise(async b=>{const h=await g.decodeAudioData(await a.arrayBuffer()),F=Hr(h,a instanceof File?a.name:a.url.split("/").pop()??"");e(v).push(F),b()}));await Promise.all(r);let n=0;for(const a of t){const b=e(v).findIndex(F=>F.id===(a instanceof File?a.name:a.url.split("/").pop()));if(b===-1)continue;const h=e(v)[b];e(v).splice(b,1),e(v).splice(n,0,h),n+=1}T(`Successfully loaded all ${t.length} files!`,"success",5e3)}catch{T("Unable to decode one or more audio files!","error",5e3)}finally{S.value="",_(c,!1)}}async function ct(t){return await new Promise(r=>setTimeout(r,t))}var pt=Yr(),_t=Se(pt);Vr(_t,{get title(){return At["adaptive-music"]},get description(){return Sr["adaptive-music"]},uri:"adaptive-music"});var Ve=s(_t,2),Qt=d(Ve,!0);u(Ve);var Ne=s(Ve,2),er=d(Ne,!0);u(Ne);var ft=s(Ne,2);Nr(ft,{});var Ee=s(ft,2),Ae=d(Ee),Me=d(Ae),R=d(Me);R.__change=async()=>{switch(e(Fe)){case"SJ21_EHS":{const t=st.parse(await(await fetch("/adaptive-music/E21_EHS.json")).json());T(`Downloading ${t.audios.length} files...`,"warning",Number.POSITIVE_INFINITY),await be(await Promise.all(t.audios.map(r=>fetch(`/adaptive-music/SJ21_EHS/${r.id}`)))),_(B,JSON.stringify(t),!0),he();break}case"sj21_grandmasterHS":{const t=st.parse(await(await fetch("/adaptive-music/sj21_grandmasterHS.json")).json());T(`Downloading ${t.audios.length} files...`,"warning",Number.POSITIVE_INFINITY),await be(await Promise.all(t.audios.map(r=>fetch(`/adaptive-music/sj21_grandmasterHS/${r.id}`)))),_(B,JSON.stringify(t),!0),he();break}}};var De=d(R);De.value=(De.__value=void 0)??"";var He=s(De);He.value=He.__value="SJ21_EHS";var vt=s(He);vt.value=vt.__value="sj21_grandmasterHS",u(R);var Pe=s(R,4);Pe.__change=t=>be(t.currentTarget.files),Ir(Pe,t=>S=t,()=>S),u(Me);var qe=s(Me,2),X=d(qe);w(X),X.__keydown=he;var gt=s(X,2);gt.__click=he,u(qe);var mt=s(qe,2);mt.__click=async()=>{navigator.clipboard.writeText(JSON.stringify({same_group_fade_in_ms:e(H),same_group_fade_out_ms:e(J),different_group_fade_in_ms:e(P),different_group_fade_out_ms:e(z),volume:N.gain.value*100,volume_fade_ms:e(E),current_phase:e(I),auto_advance_every_second:e(O),auto_advance:e(G),audios:e(v).map(t=>({id:t.id,volume:t.volume,offset:t.offset,group:t.group,bar_duration:t.bar_duration,loops:t.loops}))})),T("Copied to clipboard!","success",3e3),T("Export does not include audio files. Next time you will need to upload audio files before importing.","warning",1e4)},u(Ae);var Oe=s(Ae,2),Le=s(d(Oe),2),ht=s(d(Le),2),K=d(ht);w(K),K.__input=t=>{let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`},q(2),u(ht),u(Le);var Ce=s(Le,2),bt=s(d(Ce),2),U=d(bt);w(U),U.__input=t=>{let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`},q(2),u(bt),u(Ce);var Je=s(Ce,4),wt=s(d(Je),2),Z=d(wt);w(Z),Z.__input=t=>{let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`},q(2),u(wt),u(Je);var yt=s(Je,2),xt=s(d(yt),2),Q=d(xt);w(Q),Q.__input=t=>{let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`},q(2),u(xt),u(yt),u(Oe);var ze=s(Oe,2),Ge=d(ze),Tt=s(d(Ge),2),Be=d(Tt);Be.__input=t=>{let r=t.currentTarget.value.length;r<3&&(r=3),t.currentTarget.style.width=`${r}ch`},q(2),u(Tt),u(Ge);var Re=s(Ge,2),St=s(d(Re),2),ee=d(St);w(ee),ee.__input=t=>{let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`},q(2),u(St),u(Re);var We=s(Re,2),$t=s(d(We),2),te=d($t);w(te),te.__input=t=>{let r=t.currentTarget.value.length;r<2&&(r=2),t.currentTarget.style.width=`${r}ch`},u($t),u(We);var kt=s(We,2),Ye=s(d(kt),2),re=d(Ye);w(re),re.__input=t=>{let r=t.currentTarget.value.length;r<3&&(r=3),t.currentTarget.style.width=`${r}ch`},q(2),u(Ye);var we=s(Ye,2);w(we),we.__change=()=>{if(!e(G))return clearInterval(D);e(I)<=0&&(_(I,1),Ie()),D=setInterval(()=>{_(I,e(I)+1),Ie()},e(O)*1e3)},u(kt),u(ze);var ye=s(ze,2),Ft=d(ye),tr=s(Ft,2);{var rr=t=>{var r=Lr(),n=Se(r),a=s(n,2);W(()=>{it(n,`left: ${e(Wt)??""}px`),it(a,`left: ${e(Yt)??""}px`)}),A(t,r)};$e(tr,t=>{e(m)?.loops[e(m).progress]?.loop&&t(rr)})}u(ye);var Xe=s(ye,2),xe=d(Xe),ar=d(xe);u(xe);var Ke=s(xe,2),ir=d(Ke,!0);u(Ke);var Ue=s(Ke,2),nr=d(Ue);u(Ue),u(Xe);var jt=s(Xe,2),sr=s(d(jt),30);{var or=t=>{var r=Wr();Nt(r,31,()=>e(v),n=>n.id,(n,a,b)=>{var h=Rr(),F=d(h);{var lr=o=>{var f=Cr();A(o,f)},ur=o=>{var f=Jr();Et(f,ue=>xr?.(ue)),A(o,f)};$e(F,o=>{e(c)?o(lr):o(ur,!1)})}var Ze=s(F,2);Ze.__click=()=>{e(v).splice(e(b),1)};var ae=s(Ze,2);w(ae),ae.__change=ut;var Qe=s(ae,2),ie=d(Qe);w(ie),ie.__input=o=>{let f=o.currentTarget.value.length;f<2&&(f=2),o.currentTarget.style.width=`${f}ch`},q(2),u(Qe);var ne=s(Qe,2);w(ne);var se=s(ne,2);w(se);var et=s(se,2),oe=d(et);w(oe),oe.__input=o=>{let f=o.currentTarget.value.length;f<2&&(f=2),o.currentTarget.style.width=`${f}ch`},u(et);var le=s(et,2);w(le);var dr=s(le,2);{var cr=o=>{var f=zr();f.__click=()=>{e(a).loops.push({start:0,end:e(a).buffer.duration,phase:"",loop:!0})},W(()=>f.disabled=e(c)),A(o,f)},pr=o=>{var f=Br(),ue=Se(f);ue.__click=()=>{e(a).loops.push({start:0,end:e(a).buffer.duration,phase:"",loop:!0})};var It=s(ue,2);Nt(It,21,()=>e(a).loops,wr,(_r,V,Te,Xr)=>{var Vt=Gr(),tt=Se(Vt);tt.__click=()=>{e(a).loops.splice(Te,1)};var L=s(tt,2);w(L),$(L,Te),L.__change=()=>{e(a).start_time=g.currentTime-ve(e(a)),e(a).progress=Te,Y()};var de=s(L,2);w(de),de.__change=C=>{e(a).start_time=g.currentTime-ve(e(a)),e(V).loop=C.currentTarget.checked,Y()};var ce=s(de,2);w(ce);var pe=s(ce,2);w(pe);var rt=s(pe,2);w(rt),W(()=>{tt.disabled=e(c)||e(a).loops.length<2,kr(L,"name",e(a).id),Mt(L,Te===e(a).progress),L.disabled=e(c),Mt(de,e(V).loop),de.disabled=e(c),ce.disabled=e(c)||!e(V).loop,$(ce,e(V).start),pe.disabled=e(c)||!e(V).loop,$(pe,e(V).end),rt.disabled=e(c)}),y("blur",ce,C=>{e(V).start=parseFloat(C.currentTarget.value)||0,Y()}),y("blur",pe,C=>{e(V).end=parseFloat(C.currentTarget.value)||0,Y()}),Ht(rt,()=>e(V).phase,C=>e(V).phase=C),A(_r,Vt)}),u(It),W(()=>ue.disabled=e(c)),A(o,f)};$e(dr,o=>{e(a).loops.length?o(pr,!1):o(cr)})}u(h),W(()=>{Ze.disabled=e(c)||e(a).playing||e(ge),ae.disabled=e(c)||e(ge)||!e(a).loops.length,ie.disabled=e(c),$(ie,e(a).volume),ne.disabled=e(c),$(ne,e(a).id),se.disabled=e(c),$(se,e(a).offset),oe.disabled=e(c),$(oe,e(a).group),le.disabled=e(c),$(le,e(a).bar_duration)}),Pt(ae,()=>e(a).playing,o=>e(a).playing=o),y("blur",ie,o=>{if(e(a).volume=parseFloat(o.currentTarget.value)||0,e(a).volume/100===e(a).volume_node.gain.value)return;T("Volume changing...","warning",e(E)),e(a).volume_node.gain.cancelScheduledValues(g.currentTime),e(a).volume_node.gain.setValueAtTime(e(a).volume_node.gain.value,g.currentTime),e(a).volume_node.gain.linearRampToValueAtTime(e(a).volume/100,g.currentTime+e(E)/1e3),o.currentTarget.value=e(a).volume.toString();let f=o.currentTarget.value.length;f<3&&(f=3),o.currentTarget.style.width=`${f}ch`}),y("blur",ne,o=>{if(o.currentTarget.value!==e(a).id){if(!o.currentTarget.value.length){T("Name cannot be empty!","error",3e3),o.currentTarget.value=e(a).id;return}if(e(v).some(f=>f.id===o.currentTarget.value)){T("Name must be unique!","error",3e3),o.currentTarget.value=e(a).id;return}e(a).id=o.currentTarget.value}}),y("blur",se,o=>e(a).offset=parseFloat(o.currentTarget.value)||0),y("blur",oe,o=>{e(a).group=parseFloat(o.currentTarget.value)||0,o.currentTarget.value=e(a).group.toString();let f=o.currentTarget.value.length;f<2&&(f=2),o.currentTarget.style.width=`${f}ch`}),y("blur",le,o=>e(a).bar_duration=parseFloat(o.currentTarget.value)||0),Fr(h,()=>yr,()=>({duration:p})),A(n,h)}),u(r),Et(r,(n,a)=>Tr?.(n,a),()=>({items:e(v),flipDurationMs:p,transformDraggedElement:n=>{n?.classList.remove("grid-cols-subgrid"),n?.classList.add("grid","grid-cols-[2rem_2rem_3rem_auto_2fr_1fr_auto_1fr_2rem_2rem_2rem_3rem_1fr_1fr_1fr]","gap-x-1")}})),y("consider",r,n=>_(v,n.detail.items,!0)),y("finalize",r,n=>_(v,n.detail.items,!0)),A(t,r)};$e(sr,t=>{e(v).length&&t(or)})}u(jt),u(Ee),W(()=>{fe(Qt,At["adaptive-music"]),fe(er,$r["adaptive-music"]),at(Ee,1,`m-4 flex flex-col items-center justify-center gap-1 ${e(c)?"cursor-wait":""}`),R.disabled=e(c)||!!e(v).length,Pe.disabled=e(c),X.disabled=e(c),gt.disabled=e(c)||!e(B),mt.disabled=e(c)||!e(v).length,K.disabled=e(c),$(K,e(H)),U.disabled=e(c),$(U,e(J)),Z.disabled=e(c),$(Z,e(P)),Q.disabled=e(c),$(Q,e(z)),Be.disabled=e(c),ee.disabled=e(c),$(ee,e(E)),te.disabled=e(c),$(te,e(I)),re.disabled=e(G)||e(c),$(re,e(O)),we.disabled=e(O)<=0||e(c),it(Ft,`width: ${e(je)??""}px`),at(xe,1,Dt(e(m)?.loops[e(m).progress]?.loop?"":"text-base-content/50 line-through")),fe(ar,`Loop Start ${e(Bt)??""}`),fe(ir,e(lt)),at(Ue,1,Dt(e(m)?.loops[e(m).progress]?.loop?"":"text-base-content/50 line-through")),fe(nr,`Loop End ${e(Rt)??""}`)}),jr(R,()=>e(Fe),t=>_(Fe,t)),Ht(X,()=>e(B),t=>_(B,t)),y("blur",K,t=>{_(H,parseFloat(t.currentTarget.value)||0,!0),t.currentTarget.value=e(H).toString();let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`}),y("blur",U,t=>{_(J,parseFloat(t.currentTarget.value)||0,!0),t.currentTarget.value=e(J).toString();let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`}),y("blur",Z,t=>{_(P,parseFloat(t.currentTarget.value)||0,!0),t.currentTarget.value=e(P).toString();let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`}),y("blur",Q,t=>{_(z,parseFloat(t.currentTarget.value)||0,!0),t.currentTarget.value=e(z).toString();let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`}),y("blur",Be,t=>{const r=parseFloat(t.currentTarget.value)||0;if(r/100===N.gain.value)return;T("Volume changing...","warning",e(E)),N.gain.cancelScheduledValues(g.currentTime),N.gain.setValueAtTime(N.gain.value,g.currentTime),N.gain.linearRampToValueAtTime(r/100,g.currentTime+e(E)/1e3),t.currentTarget.value=r.toString();let n=t.currentTarget.value.length;n<3&&(n=3),t.currentTarget.style.width=`${n}ch`}),y("blur",ee,t=>{_(E,parseFloat(t.currentTarget.value)||0,!0),t.currentTarget.value=e(E).toString();let r=t.currentTarget.value.length;r<4&&(r=4),t.currentTarget.style.width=`${r}ch`}),y("blur",te,t=>{_(I,parseFloat(t.currentTarget.value)||0,!0),Ie(),t.currentTarget.value=e(I).toString();let r=t.currentTarget.value.length;r<2&&(r=2),t.currentTarget.style.width=`${r}ch`}),y("blur",re,t=>{_(O,parseFloat(t.currentTarget.value)||0,!0),t.currentTarget.value=e(O).toString();let r=t.currentTarget.value.length;r<3&&(r=3),t.currentTarget.style.width=`${r}ch`}),Pt(we,()=>e(G),t=>_(G,t)),Ar(ye,"clientWidth",t=>_(me,t)),A(i,pt),hr()}br(["change","keydown","click","input"]);export{pa as component};
