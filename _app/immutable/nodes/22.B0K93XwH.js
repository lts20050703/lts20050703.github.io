import{d as ye,f as E,a as y,c as te,s as m}from"../chunks/DUptxo_s.js";import{p as xe,u as T,b as B,i as n,d as q,g as e,f as D,s as l,c as r,t as C,a as he,r as o,y as ke,n as Se}from"../chunks/HufPbK5P.js";import{i as K}from"../chunks/BMECgONY.js";import{d as Ie,n as ae,v as je,r as Ae,s as re}from"../chunks/CParlxkP.js";import{b as Te}from"../chunks/CBEnHbB_.js";import{b as qe}from"../chunks/DqOtK87w.js";import{H as De}from"../chunks/BjvqsN9J.js";import{t as L,T as Ee}from"../chunks/CZbx98vb.js";import{s as _,l as oe,a as i,b as Fe,S as He,c as se,d as Je,x as Ne,A as Oe,i as g}from"../chunks/BYoqFsuW.js";var $e=E('<div role="alert" class="alert w-full alert-vertical alert-soft text-base alert-error"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0 stroke-current" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <div> </div> <div>Please follow the following steps:</div> <ol class="list list-decimal text-left text-base"><li> </li> <li> </li> <li>Send Link the save data</li> <li>Delete the save file</li></ol> <button class="btn btn-primary"> </button></div>'),ze=E('<span class="loading loading-xl loading-spinner"></span>'),Be=E('<!> <div class="flex items-center rounded bg-base-100 p-4"><div class="flex flex-col border p-4"><!></div></div> <hr class="my-2 w-full opacity-25"/> <div class="mt-4 flex flex-col items-center justify-center gap-1"><button class="btn btn-sm btn-primary"> </button> <div class="mt-4 flex flex-row gap-1"><input class="input input-sm input-primary" type="text"/> <button class="btn px-1 btn-sm btn-error"><!></button></div> <button class="btn btn-sm btn-error"> </button></div> <!> <!>',1),Ce=E('<!> <div class="flex justify-center"><div class="tooltip-open tooltip tooltip-error" data-tip="Debug"><button class="text-2xl font-bold"> </button></div></div> <div class="text-center"> </div> <div class="m-1 mb-12 flex items-center justify-center"><div class="flex w-full max-w-sm flex-col items-center justify-center gap-1"><!> <!></div></div>',1);function We(le,ie){xe(ie,!0);const ne=a=>{var s=$e(),v=l(r(s),2),J=r(v);o(v);var x=l(v,4),d=r(x),b=r(d,!0);o(d);var I=l(d,2),N=r(I,!0);o(I),Se(4),o(x);var h=l(x,2);h.__click=()=>{n(t,-1)};var u=r(h,!0);o(h),o(s),C(()=>{m(J,`An error occurred while loading ${(_[e(t)].label||`File #${e(t)+1}`)??""}'s save data.`),m(b,g.save_and_quit),m(N,g.copy_save_state_to_clipboard),m(u,g.save_and_quit)}),y(a,s)};let c=q("loading"),t=q(-1),S=q(void 0),f=q("");T(()=>B(()=>{n(t,parseInt(localStorage.getItem("werewolf-moderator.file")??"-1"),!0),de("werewolf-moderator")}));function de(a){const s=localStorage.getItem(a);if(s){localStorage.setItem(`werewolf-moderator[${_.length}]`,s);try{oe(s),_.push({label:"",time:i.time,deck:i.deck,roles:i.roles,players:i.players.map(v=>v.name),night:i.night,current_role:i.current_role,day:i.day})}catch(v){console.log(v),_.push({label:"",time:"setup",deck:[],roles:[],players:[],night:0,current_role:void 0,day:0})}finally{localStorage.setItem("werewolf-moderator.slots",JSON.stringify(_)),localStorage.removeItem(a)}}}T(()=>{e(t)}),T(()=>{e(c)!=="loaded"||e(t)===-1||(localStorage.setItem(`werewolf-moderator[${e(t)}]`,Fe(i)),B(()=>L("Autosaved!","success",1e3)))}),T(()=>{e(t)!==-1?(localStorage.setItem("werewolf-moderator.file",e(t).toString()),n(c,"loading"),n(c,oe(localStorage.getItem(`werewolf-moderator[${e(t)}]`)),!0),B(()=>{const a=_[e(t)];a&&(a.time=i.time,a.deck=i.deck,a.roles=i.roles,a.players=i.players.map(s=>s.name),a.night=i.night,a.current_role=i.current_role,a.day=i.day,localStorage.setItem("werewolf-moderator.slots",JSON.stringify(_)))})):(localStorage.removeItem("werewolf-moderator.file"),n(c,"loaded"))});function M(a){e(f)===""||a instanceof KeyboardEvent&&a.key!=="Enter"||localStorage.setItem(`werewolf-moderator[${e(t)}]`,e(f))}var P=Ce(),G=D(P);De(G,{get title(){return ae["werewolf-moderator"]},get description(){return Ie["werewolf-moderator"]},uri:"werewolf-moderator/debug"});var F=l(G,2),Q=r(F),R=r(Q),ve=r(R,!0);o(R),o(Q),o(F);var H=l(F,2),ce=r(H,!0);o(H);var U=l(H,2),V=r(U),W=r(V);{var fe=a=>{He(a,{get file(){return e(t)},set file(s){n(t,s,!0)},get load_save_status(){return e(c)},set load_save_status(s){n(c,s,!0)}})},ue=a=>{var s=te(),v=D(s);{var J=d=>{var b=ze();y(d,b)},x=d=>{var b=te(),I=D(b);{var N=u=>{ne(u)},h=u=>{var X=Be(),Y=D(X);se(Y,{get file(){return e(t)},set file(p){n(t,p,!0)}});var O=l(Y,2),Z=r(O),_e=r(Z);Je(_e,()=>_[e(t)],()=>e(t),()=>!1),o(Z),o(O);var $=l(O,4),j=r($);j.__pointerup=async()=>{try{navigator.clipboard.writeText(localStorage.getItem(`werewolf-moderator[${e(t)}]`)??""),L("Copied to clipboard!","success",3e3)}catch{L("Failed to copy to clipboard! The save state has been put into the input below, so you can copy it manually.","error",15e3),n(f,localStorage.getItem(`werewolf-moderator[${e(t)}]`)??"",!0),await ke(),e(S)?.focus(),e(S)?.select()}};var pe=r(j,!0);o(j);var z=l(j,2),w=r(z);Ae(w),w.__keydown=M,qe(w,p=>n(S,p),()=>e(S));var k=l(w,2);k.__click=()=>{n(f,"")};var ge=r(k);Ne(ge),o(k),o(z);var A=l(z,2);A.__click=M;var be=r(A,!0);o(A),o($);var ee=l($,2);Oe(ee,{});var we=l(ee,2);se(we,{get file(){return e(t)},set file(p){n(t,p,!0)}}),C(()=>{m(pe,g.copy_save_state_to_clipboard),re(w,"placeholder",g.save_state),k.disabled=!e(f),re(k,"aria-label",g.clear),A.disabled=!e(f),m(be,g.import_save_state)}),Te(w,()=>e(f),p=>n(f,p)),y(u,X)};K(I,u=>{e(c)==="error"?u(N):u(h,!1)},!0)}y(d,b)};K(v,d=>{e(c)==="loading"?d(J):d(x,!1)},!0)}y(a,s)};K(W,a=>{e(t)===-1?a(fe):a(ue,!1)})}var me=l(W,2);Ee(me,{}),o(V),o(U),C(()=>{m(ve,ae["werewolf-moderator"]),m(ce,je["werewolf-moderator"])}),y(le,P),he()}ye(["click","pointerup","keydown"]);export{We as component};
